
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://heal-docs-dev.io/notebooks/BACPAC_Synthetic_Data_Analysis/">
      
      <link rel="icon" href="../../img/heal_logo.png">
      <meta name="generator" content="mkdocs-1.3.1, mkdocs-material-8.5.3">
    
    
      
        <title>BACPAC Synthetic Data Analysis - HEAL Example Analysis</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7a952b86.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Montserrat";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="heal_platform" data-md-color-primary="" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#bacpac-synthetic-data-analysis" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="https://healdata.org" title="HEAL Example Analysis" class="md-header__button md-logo" aria-label="HEAL Example Analysis" data-md-component="logo">
      
  <img src="../../assets/HEAL_Initiative_White-cropped.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            HEAL Example Analysis
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              BACPAC Synthetic Data Analysis
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://healdata.org" title="HEAL Example Analysis" class="md-nav__button md-logo" aria-label="HEAL Example Analysis" data-md-component="logo">
      
  <img src="../../assets/HEAL_Initiative_White-cropped.svg" alt="logo">

    </a>
    HEAL Example Analysis
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://healdata.org/" class="md-nav__link">
        Return to Platform
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3">
          Example Analysis Notebooks
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Example Analysis Notebooks" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Example Analysis Notebooks
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          BACPAC Synthetic Data Analysis
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        BACPAC Synthetic Data Analysis
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#qiong-liu" class="md-nav__link">
    Qiong Liu
  </a>
  
    <nav class="md-nav" aria-label="Qiong Liu">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#april-2nd-2021" class="md-nav__link">
    April 2nd, 2021
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#table-of-content" class="md-nav__link">
    Table of Content
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#set-up-notebook" class="md-nav__link">
    Set up notebook
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#query-study-metadata" class="md-nav__link">
    Query study metadata
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pull-file-objects-using-the-gen3-sdk" class="md-nav__link">
    Pull file objects using the Gen3 SDK
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#demographic-characteristics-of-participants-in-bacpac" class="md-nav__link">
    Demographic characteristics of participants in BACPAC
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#opiod-pain-medication-profiling-at-two-time-points" class="md-nav__link">
    Opiod pain medication profiling at two time points
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#physical-function-outcomes" class="md-nav__link">
    Physical function outcomes
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Stigma-Reduction-Among_PCCs/" class="md-nav__link">
        Stigma Reduction Among PCCs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Opioid_Risk_Metric_Threshold_Identification-Study_Recreation/" class="md-nav__link">
        Opioid Risk Metric Threshold Identification - Study Recreation
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../faq/" class="md-nav__link">
        FAQs
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../contact/" class="md-nav__link">
        Contact
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#qiong-liu" class="md-nav__link">
    Qiong Liu
  </a>
  
    <nav class="md-nav" aria-label="Qiong Liu">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#april-2nd-2021" class="md-nav__link">
    April 2nd, 2021
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#table-of-content" class="md-nav__link">
    Table of Content
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#set-up-notebook" class="md-nav__link">
    Set up notebook
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#query-study-metadata" class="md-nav__link">
    Query study metadata
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pull-file-objects-using-the-gen3-sdk" class="md-nav__link">
    Pull file objects using the Gen3 SDK
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#demographic-characteristics-of-participants-in-bacpac" class="md-nav__link">
    Demographic characteristics of participants in BACPAC
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#opiod-pain-medication-profiling-at-two-time-points" class="md-nav__link">
    Opiod pain medication profiling at two time points
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#physical-function-outcomes" class="md-nav__link">
    Physical function outcomes
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="bacpac-synthetic-data-analysis">BACPAC Synthetic Data Analysis<a class="headerlink" href="#bacpac-synthetic-data-analysis" title="Permanent link">&para;</a></h1>
<h2 id="qiong-liu">Qiong Liu<a class="headerlink" href="#qiong-liu" title="Permanent link">&para;</a></h2>
<h3 id="april-2nd-2021">April 2nd, 2021<a class="headerlink" href="#april-2nd-2021" title="Permanent link">&para;</a></h3>
<p>In this Jupyter notebook, we used the BACPAC study as an example to demonstrate how to navigate datasets within the workspace in HEAL and conduct data analysis using Python libraries.</p>
<h2 id="table-of-content">Table of Content<a class="headerlink" href="#table-of-content" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="#h1">Set up notebook</a></li>
<li><a href="#Pull-file-objects-using-the-Gen3-SDK">Pull file objects using the Gen3 SDK</a></li>
<li><a href="#Demographic-characteristics-of-participants-in-BACPAC">Demographic characteristics of participants in BACPAC</a></li>
<li><a href="#Opiod-pain-medication-profiling-at-two-time-points">Opiod pain medication profiling at two time points</a></li>
<li><a href="#Physical-function-outcomes">Physical function outcomes</a></li>
</ul>
<h2 id="set-up-notebook">Set up notebook<a class="headerlink" href="#set-up-notebook" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="c1"># Uncomment the line to install python libraries by removing #</span>
<span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">kaleido</span><span class="o">==</span><span class="mf">0.2.1</span> <span class="o">-</span><span class="n">q</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">kaleido</span>
<span class="kn">import</span> <span class="nn">plotly</span>
<span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
<span class="kn">from</span> <span class="nn">plotly.subplots</span> <span class="kn">import</span> <span class="n">make_subplots</span>
<span class="kn">import</span> <span class="nn">plotly.io</span> <span class="k">as</span> <span class="nn">pio</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="n">plotly</span><span class="o">.</span><span class="n">offline</span><span class="o">.</span><span class="n">init_notebook_mode</span><span class="p">()</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Markdown</span><span class="p">,</span> <span class="n">Image</span><span class="p">,</span> <span class="n">display</span>
</code></pre></div>
<h2 id="query-study-metadata">Query study metadata<a class="headerlink" href="#query-study-metadata" title="Permanent link">&para;</a></h2>
<p>Users can query study metadata in HEAL data commons using our metadata service (MDS). The cell below shows how to retrieve the metadata of the BACPAC study by interacting with the gen3 MDS endpoint.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Query the metadata of BACPAC using the project number &quot;1U24AR076730-01&quot;</span>
<span class="n">response</span><span class="o">=</span><span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;https://healdata.org/mds/metadata?data=True&amp;limit=1000&amp;gen3_discovery.project_number=1U24AR076730-01&quot;</span><span class="p">)</span>
<span class="n">metadata_text</span><span class="o">=</span><span class="n">response</span><span class="o">.</span><span class="n">text</span>
<span class="n">metadata_object</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">metadata_text</span><span class="p">)</span>
<span class="n">meta_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">json_normalize</span><span class="p">([</span><span class="n">sub</span><span class="p">[</span><span class="s1">&#39;gen3_discovery&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">sub</span> <span class="ow">in</span> <span class="n">metadata_object</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="s1">&#39;gen3_discovery&#39;</span> <span class="ow">in</span> <span class="n">sub</span><span class="o">.</span><span class="n">keys</span><span class="p">()])</span>
<span class="n">Markdown</span><span class="p">(</span><span class="n">meta_df</span><span class="p">[[</span><span class="s1">&#39;research_focus_area&#39;</span><span class="p">,</span> <span class="s1">&#39;study_metadata.minimal_info.study_description&#39;</span><span class="p">,</span> <span class="s1">&#39;institutions&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div>
<table>
<thead>
<tr>
<th align="left"></th>
<th align="left">0</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">research_focus_area</td>
<td align="left">Clinical Research in Pain Management</td>
</tr>
<tr>
<td align="left">study_metadata.minimal_info.study_description</td>
<td align="left">The BACPAC Research Programs Data Integration, Algorithm Development, and Operations Management Center (DAC) will bring cohesion to research performed by the participating Mechanistic Research Centers, Technology Research Sites, and Phase 2 Clinical Trials Centers. DAC Investigators will share their vision and provide scientific leadership and organizational support to the BACPAC Consortium. The research plan consists of supporting design and conduct of clinical trials with precision interventions that focus on identifying the best treatments for individual patients. The DAC will enhance collaboration and research progress with experienced leadership, innovative design and analysis methodologies, comprehensive research operations support, a state-of-the-art data management and integration system, and superior administrative support. This integrated structure will set the stage for technology assessments, solicitation of patient input and utilities, and the evaluation of high-impact interventions through the innovative design and sound execution of clinical trials, leading to effective personalized treatment approaches for patients with chronic lower back pain.</td>
</tr>
<tr>
<td align="left">institutions</td>
<td align="left">UNIV OF NORTH CAROLINA CHAPEL HILL</td>
</tr>
</tbody>
</table>
<h2 id="pull-file-objects-using-the-gen3-sdk">Pull file objects using the Gen3 SDK<a class="headerlink" href="#pull-file-objects-using-the-gen3-sdk" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="err">!</span><span class="n">gen3</span> <span class="n">drs</span><span class="o">-</span><span class="n">pull</span> <span class="nb">object</span> <span class="n">dg</span><span class="o">.</span><span class="n">H34L</span><span class="o">/</span><span class="mi">80</span><span class="n">f0a338</span><span class="o">-</span><span class="mf">18e0</span><span class="o">-</span><span class="mi">48</span><span class="n">de</span><span class="o">-</span><span class="n">b70f</span><span class="o">-</span><span class="n">cdabd63f67d9</span>
<span class="err">!</span><span class="n">gen3</span> <span class="n">drs</span><span class="o">-</span><span class="n">pull</span> <span class="nb">object</span> <span class="n">dg</span><span class="o">.</span><span class="n">H34L</span><span class="o">/</span><span class="mi">530</span><span class="n">fd95c</span><span class="o">-</span><span class="mi">48</span><span class="n">b6</span><span class="o">-</span><span class="mi">488</span><span class="n">e</span><span class="o">-</span><span class="n">a699</span><span class="o">-</span><span class="mi">9377180</span><span class="n">bd82d</span>
<span class="err">!</span><span class="n">gen3</span> <span class="n">drs</span><span class="o">-</span><span class="n">pull</span> <span class="nb">object</span> <span class="n">dg</span><span class="o">.</span><span class="n">H34L</span><span class="o">/</span><span class="mi">654</span><span class="n">d7f1f</span><span class="o">-</span><span class="n">b61c</span><span class="o">-</span><span class="mi">49</span><span class="n">a9</span><span class="o">-</span><span class="mi">8</span><span class="n">a74</span><span class="o">-</span><span class="n">c82400fa4c27</span>
</code></pre></div>
<pre><code>{"succeeded": ["dg.H34L/80f0a338-18e0-48de-b70f-cdabd63f67d9"], "failed": []}
{"succeeded": ["dg.H34L/530fd95c-48b6-488e-a699-9377180bd82d"], "failed": []}
{"succeeded": ["dg.H34L/654d7f1f-b61c-49a9-8a74-c82400fa4c27"], "failed": []}
</code></pre>
<h2 id="demographic-characteristics-of-participants-in-bacpac">Demographic characteristics of participants in BACPAC<a class="headerlink" href="#demographic-characteristics-of-participants-in-bacpac" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="c1"># Read the demographic tsv file into dataframe</span>
<span class="n">demo_bacpac</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;./participant_SMART.tsv&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>


<span class="c1"># Define age groups within participants</span>
<span class="n">age_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">demo_bacpac</span><span class="p">[</span><span class="s2">&quot;age_in_years&quot;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">age_group</span><span class="p">(</span><span class="n">agelist</span><span class="p">):</span>
    <span class="n">min_age</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">agelist</span><span class="p">)</span>
    <span class="n">grouplabel1</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">min_age</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;-55 yr&quot;</span>
    <span class="n">grouplabel2</span><span class="o">=</span> <span class="s2">&quot;&gt;55 yr&quot;</span>
    <span class="n">grouplist</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">agelist</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;=</span><span class="mi">55</span><span class="p">:</span>
            <span class="n">grouplist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">grouplabel1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">grouplist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">grouplabel2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">grouplist</span>

<span class="n">agegrouplist</span> <span class="o">=</span> <span class="n">age_group</span><span class="p">(</span><span class="n">age_list</span><span class="p">)</span>
<span class="n">demo_bacpac</span><span class="p">[</span><span class="s2">&quot;age_group&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">agegrouplist</span>

<span class="c1"># Compute three frequency tables using demographic factors</span>
<span class="n">df1</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">demo_bacpac</span><span class="p">[</span><span class="s1">&#39;race&#39;</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="n">demo_bacpac</span><span class="p">[</span><span class="s1">&#39;sex&#39;</span><span class="p">])</span>
<span class="n">df2</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">demo_bacpac</span><span class="p">[</span><span class="s1">&#39;ethnicity&#39;</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="n">demo_bacpac</span><span class="p">[</span><span class="s1">&#39;sex&#39;</span><span class="p">])</span>
<span class="n">df3</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">demo_bacpac</span><span class="p">[</span><span class="s1">&#39;age_group&#39;</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="n">demo_bacpac</span><span class="p">[</span><span class="s1">&#39;sex&#39;</span><span class="p">])</span>

<span class="c1"># Dsiplay concatenated tables</span>
<span class="n">Markdown</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">df3</span><span class="p">],</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;race&#39;</span><span class="p">,</span> <span class="s1">&#39;ethnicity&#39;</span><span class="p">,</span> <span class="s1">&#39;age_group&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div>
<table>
<thead>
<tr>
<th align="left"></th>
<th align="right">Female</th>
<th align="right">Intersex</th>
<th align="right">Male</th>
<th align="right">Unknown</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">('race', 'American Indian or Alaska Native')</td>
<td align="right">5</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">1</td>
</tr>
<tr>
<td align="left">('race', 'Asian')</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">0</td>
</tr>
<tr>
<td align="left">('race', 'Black or African American')</td>
<td align="right">9</td>
<td align="right">3</td>
<td align="right">6</td>
<td align="right">2</td>
</tr>
<tr>
<td align="left">('race', 'Multiple')</td>
<td align="right">5</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">0</td>
</tr>
<tr>
<td align="left">('race', 'Native Hawaiian or Pacific Islander')</td>
<td align="right">5</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">2</td>
</tr>
<tr>
<td align="left">('race', 'Not reported')</td>
<td align="right">4</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">1</td>
</tr>
<tr>
<td align="left">('race', 'Unknown')</td>
<td align="right">3</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">1</td>
</tr>
<tr>
<td align="left">('race', 'White')</td>
<td align="right">37</td>
<td align="right">4</td>
<td align="right">26</td>
<td align="right">12</td>
</tr>
<tr>
<td align="left">('ethnicity', 'Hispanic or Latino')</td>
<td align="right">18</td>
<td align="right">5</td>
<td align="right">12</td>
<td align="right">6</td>
</tr>
<tr>
<td align="left">('ethnicity', 'Not Hispanic or Latino')</td>
<td align="right">36</td>
<td align="right">4</td>
<td align="right">27</td>
<td align="right">6</td>
</tr>
<tr>
<td align="left">('ethnicity', 'Not reported')</td>
<td align="right">7</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">4</td>
</tr>
<tr>
<td align="left">('ethnicity', 'Unknown')</td>
<td align="right">9</td>
<td align="right">3</td>
<td align="right">5</td>
<td align="right">3</td>
</tr>
<tr>
<td align="left">('age_group', '20-55 yr')</td>
<td align="right">42</td>
<td align="right">9</td>
<td align="right">29</td>
<td align="right">14</td>
</tr>
<tr>
<td align="left">('age_group', '&gt;55 yr')</td>
<td align="right">28</td>
<td align="right">4</td>
<td align="right">19</td>
<td align="right">5</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre><span></span><code><span class="c1"># Generate a stacked bar chart of participants in BACPAC</span>
<span class="n">new_df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df2</span><span class="o">.</span><span class="n">stack</span><span class="p">())</span>
<span class="n">new_df2</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">new_df2</span> <span class="o">=</span> <span class="n">new_df2</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span><span class="s2">&quot;Count&quot;</span><span class="p">,</span> <span class="s2">&quot;sex&quot;</span><span class="p">:</span> <span class="s2">&quot;Sex&quot;</span><span class="p">,</span> <span class="s2">&quot;ethnicity&quot;</span><span class="p">:</span> <span class="s2">&quot;Ethnicity&quot;</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;columns&quot;</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">new_df2</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;Sex&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Count&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;Ethnicity&quot;</span><span class="p">,</span>
             <span class="n">title</span><span class="o">=</span> <span class="s2">&quot;Ethnicity and Sex Characteristics of Participants in the BACPAC Study&quot;</span><span class="p">,</span>
             <span class="n">width</span><span class="o">=</span> <span class="mi">800</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">write_image</span><span class="p">(</span><span class="s1">&#39;img/BACPAC/figure1.png&#39;</span><span class="p">)</span>

<span class="n">Image</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;img/BACPAC_Synthetic_Data_Analysis/figure1.png&quot;</span><span class="p">)</span>
</code></pre></div>
<p><img alt="png" src="../img/BACPAC_Synthetic_Data_Analysis/figure1.png" /></p>
<h2 id="opiod-pain-medication-profiling-at-two-time-points">Opiod pain medication profiling at two time points<a class="headerlink" href="#opiod-pain-medication-profiling-at-two-time-points" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="c1"># Read substance use tsv file into dataframe</span>
<span class="n">substance_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;./substance_use_SMART.tsv&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>

<span class="c1"># Combine substance use df and demographic df based on participant id</span>
<span class="k">def</span> <span class="nf">find_participant</span><span class="p">(</span><span class="n">mydf</span><span class="p">,</span> <span class="n">endstr</span><span class="p">):</span>
    <span class="n">participant_id</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">mydf</span><span class="p">[</span><span class="s2">&quot;submitter_id&quot;</span><span class="p">]):</span>
        <span class="n">i_participant</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="n">endstr</span><span class="p">)</span>
        <span class="n">participant_id</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i_participant</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">participant_id</span>
<span class="n">substance_participant_id</span> <span class="o">=</span> <span class="n">find_participant</span><span class="p">(</span><span class="n">substance_df</span><span class="p">,</span><span class="s2">&quot;_sc&quot;</span><span class="p">)</span>
<span class="n">substance_df</span><span class="p">[</span><span class="s2">&quot;participant_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">substance_participant_id</span>
<span class="n">demo_combine_substance</span> <span class="o">=</span> <span class="n">substance_df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">demo_bacpac</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s2">&quot;participant_id&quot;</span><span class="p">,</span>
                                            <span class="n">right_on</span><span class="o">=</span><span class="s2">&quot;submitter_id&quot;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span>

<span class="c1"># Add one property of time point in the df</span>
<span class="k">def</span> <span class="nf">find_timepoint</span><span class="p">(</span><span class="n">mydf</span><span class="p">):</span>
    <span class="n">timepoint</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">mydf</span><span class="p">[</span><span class="s2">&quot;visits.submitter_id&quot;</span><span class="p">]):</span>
        <span class="k">if</span> <span class="n">i</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;Week 0&quot;</span><span class="p">):</span>
            <span class="n">timepoint</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Week 0&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">timepoint</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Week 12&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">timepoint</span>

<span class="n">demo_combine_substance</span><span class="p">[</span><span class="s2">&quot;time_point&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">find_timepoint</span><span class="p">(</span><span class="n">demo_combine_substance</span><span class="p">)</span>

<span class="c1"># Compute a frequency table using opioid medication factor and time point factor</span>
<span class="n">opioid_crosstab</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">demo_combine_substance</span><span class="p">[</span><span class="s1">&#39;OPIOID01&#39;</span><span class="p">],</span>
                              <span class="n">columns</span><span class="o">=</span><span class="n">demo_combine_substance</span><span class="p">[</span><span class="s1">&#39;time_point&#39;</span><span class="p">])</span>
<span class="n">new_opioid</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">opioid_crosstab</span><span class="o">.</span><span class="n">stack</span><span class="p">())</span>
<span class="n">new_opioid</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">new_opioid</span> <span class="o">=</span> <span class="n">new_opioid</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span><span class="s2">&quot;Count&quot;</span><span class="p">,</span> <span class="s2">&quot;OPIOID01&quot;</span><span class="p">:</span> <span class="s2">&quot;Taking Opioid&quot;</span><span class="p">,</span> <span class="s2">&quot;time_point&quot;</span><span class="p">:</span> <span class="s2">&quot;Time Point&quot;</span><span class="p">},</span>
                               <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;columns&quot;</span><span class="p">)</span>

<span class="n">fig2</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
<span class="n">fig2</span> <span class="o">=</span><span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">new_opioid</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;Taking Opioid&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Count&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;Taking Opioid&quot;</span><span class="p">,</span>
             <span class="n">facet_row</span><span class="o">=</span><span class="s2">&quot;Time Point&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>
<span class="n">fig2</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="s2">&quot;Self-Report of Opioid Pain Medication Use at Baseline and Twelve Weeks&quot;</span><span class="p">,</span><span class="n">title_font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">fig2</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;width&quot;</span><span class="p">]</span><span class="o">=</span><span class="mf">0.6</span>

<span class="n">fig2</span><span class="o">.</span><span class="n">write_image</span><span class="p">(</span><span class="s1">&#39;img/BACPAC_Synthetic_Data_Analysis/figure2.png&#39;</span><span class="p">)</span>

<span class="n">Image</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;img/BACPAC_Synthetic_Data_Analysis/figure2.png&quot;</span><span class="p">)</span>
</code></pre></div>
<p><img alt="png" src="../img/BACPAC_Synthetic_Data_Analysis/figure2.png" /></p>
<ul>
<li>We observed an increase of participants taking opioid pain medication at the week 12 time point compared to baseline.</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1"># Generate a bar chart showing the opioid taking at two time points in different sex groups</span>
<span class="n">opioid_gender</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="n">demo_combine_substance</span><span class="p">[</span><span class="s1">&#39;OPIOID01&#39;</span><span class="p">],</span> <span class="n">demo_combine_substance</span><span class="p">[</span><span class="s1">&#39;sex&#39;</span><span class="p">]],</span>
                            <span class="n">columns</span><span class="o">=</span><span class="n">demo_combine_substance</span><span class="p">[</span><span class="s1">&#39;time_point&#39;</span><span class="p">])</span>
<span class="n">new_opioid_gender</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">opioid_gender</span><span class="o">.</span><span class="n">stack</span><span class="p">())</span>
<span class="n">new_opioid_gender</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">new_opioid_gender</span> <span class="o">=</span> <span class="n">new_opioid_gender</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span><span class="s2">&quot;Count&quot;</span><span class="p">,</span> <span class="s2">&quot;OPIOID01&quot;</span><span class="p">:</span> <span class="s2">&quot;Taking Opioid&quot;</span><span class="p">,</span>
                                              <span class="s2">&quot;time_point&quot;</span><span class="p">:</span> <span class="s2">&quot;Time Point&quot;</span><span class="p">,</span> <span class="s2">&quot;sex&quot;</span><span class="p">:</span> <span class="s2">&quot;Sex&quot;</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;columns&quot;</span><span class="p">)</span>

<span class="n">fig3</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
<span class="n">fig3</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">new_opioid_gender</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Sex&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;Count&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;Taking Opioid&quot;</span><span class="p">,</span>
             <span class="n">facet_col</span><span class="o">=</span><span class="s2">&quot;Time Point&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span>  <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;h&#39;</span><span class="p">,</span>
             <span class="n">category_orders</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Sex&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Intersex&quot;</span><span class="p">,</span> <span class="s2">&quot;Unknown&quot;</span><span class="p">,</span> <span class="s2">&quot;Male&quot;</span><span class="p">,</span> <span class="s2">&quot;Female&quot;</span><span class="p">]})</span>
<span class="n">fig3</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="s2">&quot;Opioid Pain Medication at Two Time Points in Different Sex Groups&quot;</span><span class="p">,</span> <span class="n">title_font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="n">fig3</span><span class="o">.</span><span class="n">write_image</span><span class="p">(</span><span class="s1">&#39;img/BACPAC_Synthetic_Data_Analysis/figure3.png&#39;</span><span class="p">)</span>

<span class="n">Image</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;img/BACPAC_Synthetic_Data_Analysis/figure3.png&quot;</span><span class="p">)</span>
</code></pre></div>
<p><img alt="png" src="../img/BACPAC_Synthetic_Data_Analysis/figure3.png" /></p>
<ul>
<li>We observed an increase of particpants taking opioid medication at week 12 in both male and femal groups compared to baseline week 0.</li>
</ul>
<h2 id="physical-function-outcomes">Physical function outcomes<a class="headerlink" href="#physical-function-outcomes" title="Permanent link">&para;</a></h2>
<p>The cell below uses the Physical Function 6b T-Score to display physical function outcomes in different ethnicity groups at week 0 and week 12.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Read physical_function_SMART.tsv into dataframe and merge the df with demographic</span>
<span class="n">function_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;./physical_function_SMART.tsv&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-16&quot;</span><span class="p">)</span>
<span class="n">function_participant_id</span> <span class="o">=</span> <span class="n">find_participant</span><span class="p">(</span><span class="n">function_df</span><span class="p">,</span> <span class="s2">&quot;_pf&quot;</span><span class="p">)</span>
<span class="n">function_df</span><span class="p">[</span><span class="s2">&quot;participant_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">function_participant_id</span>
<span class="n">demo_combine_function</span> <span class="o">=</span> <span class="n">function_df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">demo_bacpac</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s2">&quot;participant_id&quot;</span><span class="p">,</span>
                                          <span class="n">right_on</span><span class="o">=</span><span class="s2">&quot;submitter_id&quot;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span>
<span class="n">demo_combine_function</span><span class="p">[</span><span class="s2">&quot;time_point&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">find_timepoint</span><span class="p">(</span><span class="n">demo_combine_function</span><span class="p">)</span>

<span class="c1"># Summary table of ROMIS-Physical Function 6b T-Score in different ethnicity groups</span>
<span class="n">ethnicity_PRPF6BT</span> <span class="o">=</span> <span class="n">demo_combine_function</span><span class="p">[[</span><span class="s2">&quot;time_point&quot;</span><span class="p">,</span>
                                           <span class="s2">&quot;PRPF6BT&quot;</span><span class="p">,</span>
                                           <span class="s2">&quot;ethnicity&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;time_point&#39;</span><span class="p">,</span><span class="s1">&#39;ethnicity&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
<span class="n">Markdown</span><span class="p">(</span><span class="n">ethnicity_PRPF6BT</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</code></pre></div>
<table>
<thead>
<tr>
<th align="left"></th>
<th align="right">('PRPF6BT', 'count')</th>
<th align="right">('PRPF6BT', 'mean')</th>
<th align="right">('PRPF6BT', 'std')</th>
<th align="right">('PRPF6BT', 'min')</th>
<th align="right">('PRPF6BT', '25%')</th>
<th align="right">('PRPF6BT', '50%')</th>
<th align="right">('PRPF6BT', '75%')</th>
<th align="right">('PRPF6BT', 'max')</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">('Week 0', 'Hispanic or Latino')</td>
<td align="right">41</td>
<td align="right">38.2854</td>
<td align="right">3.16501</td>
<td align="right">32.5</td>
<td align="right">36</td>
<td align="right">38.5</td>
<td align="right">39.3</td>
<td align="right">48.7</td>
</tr>
<tr>
<td align="left">('Week 0', 'Not Hispanic or Latino')</td>
<td align="right">73</td>
<td align="right">37.5411</td>
<td align="right">2.59823</td>
<td align="right">31.5</td>
<td align="right">35.1</td>
<td align="right">37.6</td>
<td align="right">39.3</td>
<td align="right">44.2</td>
</tr>
<tr>
<td align="left">('Week 0', 'Not reported')</td>
<td align="right">16</td>
<td align="right">37.6125</td>
<td align="right">2.93754</td>
<td align="right">33.4</td>
<td align="right">35.1</td>
<td align="right">38.05</td>
<td align="right">40.2</td>
<td align="right">43.1</td>
</tr>
<tr>
<td align="left">('Week 0', 'Unknown')</td>
<td align="right">20</td>
<td align="right">38.195</td>
<td align="right">2.46736</td>
<td align="right">31.5</td>
<td align="right">37.4</td>
<td align="right">38.5</td>
<td align="right">39.3</td>
<td align="right">42.1</td>
</tr>
<tr>
<td align="left">('Week 12', 'Hispanic or Latino')</td>
<td align="right">41</td>
<td align="right">37.5366</td>
<td align="right">3.06299</td>
<td align="right">29.1</td>
<td align="right">35.1</td>
<td align="right">37.6</td>
<td align="right">39.3</td>
<td align="right">43.1</td>
</tr>
<tr>
<td align="left">('Week 12', 'Not Hispanic or Latino')</td>
<td align="right">73</td>
<td align="right">37.589</td>
<td align="right">3.24267</td>
<td align="right">31.5</td>
<td align="right">35.1</td>
<td align="right">37.6</td>
<td align="right">40.2</td>
<td align="right">44.2</td>
</tr>
<tr>
<td align="left">('Week 12', 'Not reported')</td>
<td align="right">16</td>
<td align="right">37.7438</td>
<td align="right">2.74007</td>
<td align="right">33.4</td>
<td align="right">36</td>
<td align="right">36.8</td>
<td align="right">39.525</td>
<td align="right">43.1</td>
</tr>
<tr>
<td align="left">('Week 12', 'Unknown')</td>
<td align="right">20</td>
<td align="right">36.925</td>
<td align="right">3.26366</td>
<td align="right">29.1</td>
<td align="right">35.1</td>
<td align="right">36</td>
<td align="right">38.7</td>
<td align="right">44.2</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre><span></span><code><span class="c1"># Visualize the distribution of Physical Function 6b T-Score</span>
<span class="c1"># at two time points for hispanic and non-hispanic ethnicity groups</span>
<span class="n">fig4</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

<span class="n">fig4</span> <span class="o">=</span> <span class="n">make_subplots</span><span class="p">(</span>
    <span class="n">rows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">specs</span><span class="o">=</span><span class="p">[[{</span><span class="s2">&quot;colspan&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="kc">None</span><span class="p">],</span>
           <span class="p">[{},</span> <span class="p">{}]],</span>
    <span class="n">subplot_titles</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;PROMIS-Physical Function 6b T-Score Distribution at Two Time Points&quot;</span><span class="p">,</span><span class="s2">&quot;Hispanic or Latino&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Not Hispanic or Latino&quot;</span><span class="p">))</span>

<span class="n">fig4</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Histogram</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">demo_combine_function</span><span class="p">[</span><span class="n">demo_combine_function</span><span class="p">[</span><span class="s2">&quot;time_point&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;Week 0&quot;</span><span class="p">][</span><span class="s2">&quot;PRPF6BT&quot;</span><span class="p">],</span>
                           <span class="n">marker_color</span><span class="o">=</span><span class="s1">&#39;#EB89B5&#39;</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">nbinsx</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Week 0&quot;</span><span class="p">),</span>
               <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fig4</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Histogram</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">demo_combine_function</span><span class="p">[</span><span class="n">demo_combine_function</span><span class="p">[</span><span class="s2">&quot;time_point&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;Week 12&quot;</span><span class="p">][</span><span class="s2">&quot;PRPF6BT&quot;</span><span class="p">],</span>
                           <span class="n">marker_color</span><span class="o">=</span><span class="s1">&#39;#2B6CBE&#39;</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">nbinsx</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Week 12&quot;</span><span class="p">),</span>
               <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fig4</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Histogram</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">demo_combine_function</span><span class="p">[(</span><span class="n">demo_combine_function</span><span class="p">[</span><span class="s2">&quot;time_point&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;Week 0&quot;</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">demo_combine_function</span><span class="p">[</span><span class="s2">&quot;ethnicity&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;Hispanic or Latino&quot;</span><span class="p">)][</span><span class="s2">&quot;PRPF6BT&quot;</span><span class="p">],</span>
                           <span class="n">marker_color</span><span class="o">=</span><span class="s1">&#39;#EB89B5&#39;</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">nbinsx</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
               <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fig4</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Histogram</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">demo_combine_function</span><span class="p">[(</span><span class="n">demo_combine_function</span><span class="p">[</span><span class="s2">&quot;time_point&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;Week 12&quot;</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">demo_combine_function</span><span class="p">[</span><span class="s2">&quot;ethnicity&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;Hispanic or Latino&quot;</span><span class="p">)][</span><span class="s2">&quot;PRPF6BT&quot;</span><span class="p">],</span>
                           <span class="n">marker_color</span><span class="o">=</span><span class="s1">&#39;#2B6CBE&#39;</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">nbinsx</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
               <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fig4</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Histogram</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">demo_combine_function</span><span class="p">[(</span><span class="n">demo_combine_function</span><span class="p">[</span><span class="s2">&quot;time_point&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;Week 0&quot;</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">demo_combine_function</span><span class="p">[</span><span class="s2">&quot;ethnicity&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;Not Hispanic or Latino&quot;</span><span class="p">)][</span><span class="s2">&quot;PRPF6BT&quot;</span><span class="p">],</span>
                           <span class="n">marker_color</span><span class="o">=</span><span class="s1">&#39;#EB89B5&#39;</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">nbinsx</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
               <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">fig4</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Histogram</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">demo_combine_function</span><span class="p">[(</span><span class="n">demo_combine_function</span><span class="p">[</span><span class="s2">&quot;time_point&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;Week 12&quot;</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">demo_combine_function</span><span class="p">[</span><span class="s2">&quot;ethnicity&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;Not Hispanic or Latino&quot;</span><span class="p">)][</span><span class="s2">&quot;PRPF6BT&quot;</span><span class="p">],</span>
                           <span class="n">marker_color</span><span class="o">=</span><span class="s1">&#39;#2B6CBE&#39;</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">nbinsx</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
               <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">fig4</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">barmode</span><span class="o">=</span><span class="s1">&#39;overlay&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span><span class="n">legend_title_text</span><span class="o">=</span><span class="s1">&#39;Time Point&#39;</span><span class="p">)</span>
<span class="n">fig4</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">margin</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">l</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="n">fig4</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="s2">&quot;Count&quot;</span><span class="p">,</span>
                  <span class="n">title_font_size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fig4</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="s2">&quot;PROMIS-Physical Function 6b T-Score&quot;</span><span class="p">,</span>
                  <span class="n">title_font_size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
                  <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="mi">29</span><span class="p">,</span> <span class="mi">49</span><span class="p">],</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fig4</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="s2">&quot;Count&quot;</span><span class="p">,</span>
                  <span class="n">title_font_size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span> <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fig4</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="s2">&quot;PROMIS-Physical Function 6b T-Score&quot;</span><span class="p">,</span>
                  <span class="n">title_font_size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="mi">29</span><span class="p">,</span> <span class="mi">49</span><span class="p">],</span> <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fig4</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="s2">&quot;Count&quot;</span><span class="p">,</span>
                  <span class="n">title_font_size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span> <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">fig4</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="s2">&quot;PROMIS-Physical Function 6b T-Score&quot;</span><span class="p">,</span>
                  <span class="n">title_font_size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="mi">29</span><span class="p">,</span> <span class="mi">49</span><span class="p">],</span> <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">fig4</span><span class="o">.</span><span class="n">write_image</span><span class="p">(</span><span class="s1">&#39;img/BACPAC_Synthetic_Data_Analysis/figure4.png&#39;</span><span class="p">)</span>

<span class="n">Image</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;img/BACPAC_Synthetic_Data_Analysis/figure4.png&quot;</span><span class="p">)</span>
</code></pre></div>
<p><img alt="png" src="../img/BACPAC_Synthetic_Data_Analysis/figure4.png" /></p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../.." class="md-footer__link md-footer__link--prev" aria-label="Previous: Home" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Home
            </div>
          </div>
        </a>
      
      
        
        <a href="../Stigma-Reduction-Among_PCCs/" class="md-footer__link md-footer__link--next" aria-label="Next: Stigma Reduction Among PCCs" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Stigma Reduction Among PCCs
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.indexes", "navigation.indexes", "navigation.tracking"], "search": "../../assets/javascripts/workers/search.5bf1dace.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.37e9125f.min.js"></script>
      
    
  </body>
</html>