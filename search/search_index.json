{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"The HEAL Platform \u00b6 The HEAL Platform is a cloud-based and multifunctional web interface that provides a secure environment for discovery and analysis of NIH HEAL results and data. It is designed to serve users with a variety of objectives, backgrounds, and specialties. The HEAL Platform represents a dynamic Data Ecosystem that aggregates and presents data from multiple resources to make data discovery and access easy for users. The platform provides a way to search and query over study metadata and diverse data types, generated by different projects and organizations and stored across multiple secure repositories. The HEAL Platform also offers a secure and cost-effective cloud-computing environment for data analysis, empowering collaborative research and development of new analytical tools. New workflows and results of analyses can be shared with the HEAL community to enable collaborative, high-impact publications that address the opioid crisis. The HEAL Platform is powered by the open-source software \u201cGen3\u201d . Gen3 was created by and is actively developed at the University of Chicago\u2019s Center for Translational Data Science (CTDS) with the aim of creating interoperable cloud-based data resources for the scientific research community. HEAL Example Analyses \u00b6 The Jupyter notebooks contained in this notebook viewer pull data from various sources to generate and output useful tables, charts, graphs, and models. Each notebook is static, meaning the data being used by the notebooks is not updated in real time. Most of these notebooks are also available in the Gen3 Tutorials Workspace. Please note these notebooks are meant for illustrative purposes only, and are not meant to portray peer-reviewed research. Powered by","title":"Home"},{"location":"#the-heal-platform","text":"The HEAL Platform is a cloud-based and multifunctional web interface that provides a secure environment for discovery and analysis of NIH HEAL results and data. It is designed to serve users with a variety of objectives, backgrounds, and specialties. The HEAL Platform represents a dynamic Data Ecosystem that aggregates and presents data from multiple resources to make data discovery and access easy for users. The platform provides a way to search and query over study metadata and diverse data types, generated by different projects and organizations and stored across multiple secure repositories. The HEAL Platform also offers a secure and cost-effective cloud-computing environment for data analysis, empowering collaborative research and development of new analytical tools. New workflows and results of analyses can be shared with the HEAL community to enable collaborative, high-impact publications that address the opioid crisis. The HEAL Platform is powered by the open-source software \u201cGen3\u201d . Gen3 was created by and is actively developed at the University of Chicago\u2019s Center for Translational Data Science (CTDS) with the aim of creating interoperable cloud-based data resources for the scientific research community.","title":"The HEAL Platform"},{"location":"#heal-example-analyses","text":"The Jupyter notebooks contained in this notebook viewer pull data from various sources to generate and output useful tables, charts, graphs, and models. Each notebook is static, meaning the data being used by the notebooks is not updated in real time. Most of these notebooks are also available in the Gen3 Tutorials Workspace. Please note these notebooks are meant for illustrative purposes only, and are not meant to portray peer-reviewed research. Powered by","title":"HEAL Example Analyses"},{"location":"contact/","text":"Contact \u00b6 Need help? Please contact our help desk . Powered by","title":"Contact"},{"location":"contact/#contact","text":"Need help? Please contact our help desk . Powered by","title":"Contact"},{"location":"faq/","text":"FAQs \u00b6 How can I access the data used in these analyses? The HEAL Platform Documentation has information on how you can discover shared data through the HEAL Discovery Page , and how you can request access to a study . How can I work with the data in HEAL Workspaces? The HEAL Workspaces documentation has information on how you may access and use HEAL Workspaces. Can I share a notebook that my team has developed for analyzing data accessed through the HEAL Data Platform? Yes! We encourage investigators (and their students & trainees!) to share materials they've developed through the secondary use of HEAL data. Whether it's replicating published results, combining data from multiple studies, or extending analyses, we would be glad to share those notebooks on the HEAL Data Platform and credit your team. If you have a notebook you'd like to share, please email us at heal-support@gen3.org .","title":"FAQs"},{"location":"faq/#faqs","text":"How can I access the data used in these analyses? The HEAL Platform Documentation has information on how you can discover shared data through the HEAL Discovery Page , and how you can request access to a study . How can I work with the data in HEAL Workspaces? The HEAL Workspaces documentation has information on how you may access and use HEAL Workspaces. Can I share a notebook that my team has developed for analyzing data accessed through the HEAL Data Platform? Yes! We encourage investigators (and their students & trainees!) to share materials they've developed through the secondary use of HEAL data. Whether it's replicating published results, combining data from multiple studies, or extending analyses, we would be glad to share those notebooks on the HEAL Data Platform and credit your team. If you have a notebook you'd like to share, please email us at heal-support@gen3.org .","title":"FAQs"},{"location":"notebooks/BACPAC_Synthetic_Data_Analysis/","text":"BACPAC Synthetic Data Analysis \u00b6 Qiong Liu \u00b6 April 2nd, 2021 \u00b6 In this Jupyter notebook, we used the BACPAC study as an example to demonstrate how to navigate datasets within the workspace in HEAL and conduct data analysis using Python libraries. Table of Content \u00b6 Set up notebook Pull file objects using the Gen3 SDK Demographic characteristics of participants in BACPAC Opiod pain medication profiling at two time points Physical function outcomes Set up notebook \u00b6 # Uncomment the line to install python libraries by removing # ! pip install kaleido == 0.2.1 - q import pandas as pd import kaleido import plotly import plotly.graph_objects as go import plotly.express as px from plotly.subplots import make_subplots import plotly.io as pio from pathlib import Path import numpy as np import json import requests import os plotly . offline . init_notebook_mode () from IPython.display import Markdown , Image , display os . makedirs ( 'img/BACPAC_Synthetic_Data_Analysis' ) Query study metadata \u00b6 Users can query study metadata in HEAL data commons using our metadata service (MDS). The cell below shows how to retrieve the metadata of the BACPAC study by interacting with the gen3 MDS endpoint. # Query the metadata of BACPAC using the project number \"1U24AR076730-01\" response = requests . get ( \"https://healdata.org/mds/metadata?data=True&limit=1000&gen3_discovery.project_number=1U24AR076730-01\" ) metadata_text = response . text metadata_object = json . loads ( metadata_text ) meta_df = pd . json_normalize ([ sub [ 'gen3_discovery' ] for sub in metadata_object . values () if 'gen3_discovery' in sub . keys ()]) Markdown ( meta_df [[ 'research_focus_area' , 'study_metadata.minimal_info.study_description' , 'institutions' ]] . transpose () . to_markdown ()) 0 research_focus_area Clinical Research in Pain Management study_metadata.minimal_info.study_description The BACPAC Research Programs Data Integration, Algorithm Development, and Operations Management Center (DAC) will bring cohesion to research performed by the participating Mechanistic Research Centers, Technology Research Sites, and Phase 2 Clinical Trials Centers. DAC Investigators will share their vision and provide scientific leadership and organizational support to the BACPAC Consortium. The research plan consists of supporting design and conduct of clinical trials with precision interventions that focus on identifying the best treatments for individual patients. The DAC will enhance collaboration and research progress with experienced leadership, innovative design and analysis methodologies, comprehensive research operations support, a state-of-the-art data management and integration system, and superior administrative support. This integrated structure will set the stage for technology assessments, solicitation of patient input and utilities, and the evaluation of high-impact interventions through the innovative design and sound execution of clinical trials, leading to effective personalized treatment approaches for patients with chronic lower back pain. institutions UNIV OF NORTH CAROLINA CHAPEL HILL Pull file objects using the Gen3 SDK \u00b6 ! gen3 drs - pull object dg . H34L / 80 f0a338 - 18e0 - 48 de - b70f - cdabd63f67d9 ! gen3 drs - pull object dg . H34L / 530 fd95c - 48 b6 - 488 e - a699 - 9377180 bd82d ! gen3 drs - pull object dg . H34L / 654 d7f1f - b61c - 49 a9 - 8 a74 - c82400fa4c27 {\"succeeded\": [\"dg.H34L/80f0a338-18e0-48de-b70f-cdabd63f67d9\"], \"failed\": []} {\"succeeded\": [\"dg.H34L/530fd95c-48b6-488e-a699-9377180bd82d\"], \"failed\": []} {\"succeeded\": [\"dg.H34L/654d7f1f-b61c-49a9-8a74-c82400fa4c27\"], \"failed\": []} Demographic characteristics of participants in BACPAC \u00b6 # Read the demographic tsv file into dataframe demo_bacpac = pd . read_csv ( \"./participant_SMART.tsv\" , sep = \" \\t \" , encoding = \"utf-8\" ) # Define age groups within participants age_list = list ( demo_bacpac [ \"age_in_years\" ]) def age_group ( agelist ): min_age = min ( agelist ) grouplabel1 = str ( min_age ) + \"-55 yr\" grouplabel2 = \">55 yr\" grouplist = [] for i in agelist : if i <= 55 : grouplist . append ( grouplabel1 ) else : grouplist . append ( grouplabel2 ) return grouplist agegrouplist = age_group ( age_list ) demo_bacpac [ \"age_group\" ] = agegrouplist # Compute three frequency tables using demographic factors df1 = pd . crosstab ( index = demo_bacpac [ 'race' ], columns = demo_bacpac [ 'sex' ]) df2 = pd . crosstab ( index = demo_bacpac [ 'ethnicity' ], columns = demo_bacpac [ 'sex' ]) df3 = pd . crosstab ( index = demo_bacpac [ 'age_group' ], columns = demo_bacpac [ 'sex' ]) # Dsiplay concatenated tables Markdown ( pd . concat ([ df1 , df2 , df3 ], keys = [ 'race' , 'ethnicity' , 'age_group' ]) . to_markdown ()) Female Intersex Male Unknown ('race', 'American Indian or Alaska Native') 5 1 3 1 ('race', 'Asian') 2 0 3 0 ('race', 'Black or African American') 9 3 6 2 ('race', 'Multiple') 5 1 4 0 ('race', 'Native Hawaiian or Pacific Islander') 5 0 1 2 ('race', 'Not reported') 4 2 2 1 ('race', 'Unknown') 3 2 3 1 ('race', 'White') 37 4 26 12 ('ethnicity', 'Hispanic or Latino') 18 5 12 6 ('ethnicity', 'Not Hispanic or Latino') 36 4 27 6 ('ethnicity', 'Not reported') 7 1 4 4 ('ethnicity', 'Unknown') 9 3 5 3 ('age_group', '20-55 yr') 42 9 29 14 ('age_group', '>55 yr') 28 4 19 5 # Generate a stacked bar chart of participants in BACPAC new_df2 = pd . DataFrame ( df2 . stack ()) new_df2 . reset_index ( inplace = True ) new_df2 = new_df2 . rename ({ 0 : \"Count\" , \"sex\" : \"Sex\" , \"ethnicity\" : \"Ethnicity\" }, axis = \"columns\" ) fig = go . Figure () fig = px . bar ( new_df2 , x = \"Sex\" , y = \"Count\" , color = \"Ethnicity\" , title = \"Ethnicity and Sex Characteristics of Participants in the BACPAC Study\" , width = 800 , height = 500 ) fig . write_image ( 'img/BACPAC/figure1.png' ) Image ( filename = \"img/BACPAC_Synthetic_Data_Analysis/figure1.png\" ) Opiod pain medication profiling at two time points \u00b6 # Read substance use tsv file into dataframe substance_df = pd . read_csv ( \"./substance_use_SMART.tsv\" , sep = \" \\t \" , encoding = \"utf-8\" ) # Combine substance use df and demographic df based on participant id def find_participant ( mydf , endstr ): participant_id = [] for i in list ( mydf [ \"submitter_id\" ]): i_participant = i . rstrip ( endstr ) participant_id . append ( i_participant ) return participant_id substance_participant_id = find_participant ( substance_df , \"_sc\" ) substance_df [ \"participant_id\" ] = substance_participant_id demo_combine_substance = substance_df . merge ( demo_bacpac , left_on = \"participant_id\" , right_on = \"submitter_id\" , how = \"outer\" ) # Add one property of time point in the df def find_timepoint ( mydf ): timepoint = [] for i in list ( mydf [ \"visits.submitter_id\" ]): if i . endswith ( \"Week 0\" ): timepoint . append ( \"Week 0\" ) else : timepoint . append ( \"Week 12\" ) return timepoint demo_combine_substance [ \"time_point\" ] = find_timepoint ( demo_combine_substance ) # Compute a frequency table using opioid medication factor and time point factor opioid_crosstab = pd . crosstab ( index = demo_combine_substance [ 'OPIOID01' ], columns = demo_combine_substance [ 'time_point' ]) new_opioid = pd . DataFrame ( opioid_crosstab . stack ()) new_opioid . reset_index ( inplace = True ) new_opioid = new_opioid . rename ({ 0 : \"Count\" , \"OPIOID01\" : \"Taking Opioid\" , \"time_point\" : \"Time Point\" }, axis = \"columns\" ) fig2 = go . Figure () fig2 = px . bar ( new_opioid , x = \"Taking Opioid\" , y = \"Count\" , color = \"Taking Opioid\" , facet_row = \"Time Point\" , width = 800 , height = 400 ) fig2 . update_layout ( title_text = \"Self-Report of Opioid Pain Medication Use at Baseline and Twelve Weeks\" , title_font_size = 20 ) for data in fig2 . data : data [ \"width\" ] = 0.6 fig2 . write_image ( 'img/BACPAC_Synthetic_Data_Analysis/figure2.png' ) Image ( filename = \"img/BACPAC_Synthetic_Data_Analysis/figure2.png\" ) We observed an increase of participants taking opioid pain medication at the week 12 time point compared to baseline. # Generate a bar chart showing the opioid taking at two time points in different sex groups opioid_gender = pd . crosstab ( index = [ demo_combine_substance [ 'OPIOID01' ], demo_combine_substance [ 'sex' ]], columns = demo_combine_substance [ 'time_point' ]) new_opioid_gender = pd . DataFrame ( opioid_gender . stack ()) new_opioid_gender . reset_index ( inplace = True ) new_opioid_gender = new_opioid_gender . rename ({ 0 : \"Count\" , \"OPIOID01\" : \"Taking Opioid\" , \"time_point\" : \"Time Point\" , \"sex\" : \"Sex\" }, axis = \"columns\" ) fig3 = go . Figure () fig3 = px . bar ( new_opioid_gender , y = \"Sex\" , x = \"Count\" , color = \"Taking Opioid\" , facet_col = \"Time Point\" , width = 800 , height = 400 , orientation = 'h' , category_orders = { \"Sex\" : [ \"Intersex\" , \"Unknown\" , \"Male\" , \"Female\" ]}) fig3 . update_layout ( title_text = \"Opioid Pain Medication at Two Time Points in Different Sex Groups\" , title_font_size = 20 ) fig3 . write_image ( 'img/BACPAC_Synthetic_Data_Analysis/figure3.png' ) Image ( filename = \"img/BACPAC_Synthetic_Data_Analysis/figure3.png\" ) We observed an increase of particpants taking opioid medication at week 12 in both male and femal groups compared to baseline week 0. Physical function outcomes \u00b6 The cell below uses the Physical Function 6b T-Score to display physical function outcomes in different ethnicity groups at week 0 and week 12. # Read physical_function_SMART.tsv into dataframe and merge the df with demographic function_df = pd . read_csv ( \"./physical_function_SMART.tsv\" , sep = \" \\t \" , encoding = \"utf-16\" ) function_participant_id = find_participant ( function_df , \"_pf\" ) function_df [ \"participant_id\" ] = function_participant_id demo_combine_function = function_df . merge ( demo_bacpac , left_on = \"participant_id\" , right_on = \"submitter_id\" , how = \"outer\" ) demo_combine_function [ \"time_point\" ] = find_timepoint ( demo_combine_function ) # Summary table of ROMIS-Physical Function 6b T-Score in different ethnicity groups ethnicity_PRPF6BT = demo_combine_function [[ \"time_point\" , \"PRPF6BT\" , \"ethnicity\" ]] . groupby ([ 'time_point' , 'ethnicity' ]) . describe () Markdown ( ethnicity_PRPF6BT . to_markdown ()) ('PRPF6BT', 'count') ('PRPF6BT', 'mean') ('PRPF6BT', 'std') ('PRPF6BT', 'min') ('PRPF6BT', '25%') ('PRPF6BT', '50%') ('PRPF6BT', '75%') ('PRPF6BT', 'max') ('Week 0', 'Hispanic or Latino') 41 38.2854 3.16501 32.5 36 38.5 39.3 48.7 ('Week 0', 'Not Hispanic or Latino') 73 37.5411 2.59823 31.5 35.1 37.6 39.3 44.2 ('Week 0', 'Not reported') 16 37.6125 2.93754 33.4 35.1 38.05 40.2 43.1 ('Week 0', 'Unknown') 20 38.195 2.46736 31.5 37.4 38.5 39.3 42.1 ('Week 12', 'Hispanic or Latino') 41 37.5366 3.06299 29.1 35.1 37.6 39.3 43.1 ('Week 12', 'Not Hispanic or Latino') 73 37.589 3.24267 31.5 35.1 37.6 40.2 44.2 ('Week 12', 'Not reported') 16 37.7438 2.74007 33.4 36 36.8 39.525 43.1 ('Week 12', 'Unknown') 20 36.925 3.26366 29.1 35.1 36 38.7 44.2 # Visualize the distribution of Physical Function 6b T-Score # at two time points for hispanic and non-hispanic ethnicity groups fig4 = go . Figure () fig4 = make_subplots ( rows = 2 , cols = 2 , specs = [[{ \"colspan\" : 2 }, None ], [{}, {}]], subplot_titles = ( \"PROMIS-Physical Function 6b T-Score Distribution at Two Time Points\" , \"Hispanic or Latino\" , \"Not Hispanic or Latino\" )) fig4 . add_trace ( go . Histogram ( x = demo_combine_function [ demo_combine_function [ \"time_point\" ] == \"Week 0\" ][ \"PRPF6BT\" ], marker_color = '#EB89B5' , opacity = 0.75 , nbinsx = 20 , name = \"Week 0\" ), row = 1 , col = 1 ) fig4 . add_trace ( go . Histogram ( x = demo_combine_function [ demo_combine_function [ \"time_point\" ] == \"Week 12\" ][ \"PRPF6BT\" ], marker_color = '#2B6CBE' , opacity = 0.75 , nbinsx = 20 , name = \"Week 12\" ), row = 1 , col = 1 ) fig4 . add_trace ( go . Histogram ( x = demo_combine_function [( demo_combine_function [ \"time_point\" ] == \"Week 0\" ) & ( demo_combine_function [ \"ethnicity\" ] == \"Hispanic or Latino\" )][ \"PRPF6BT\" ], marker_color = '#EB89B5' , opacity = 0.75 , nbinsx = 20 , showlegend = False ), row = 2 , col = 1 ) fig4 . add_trace ( go . Histogram ( x = demo_combine_function [( demo_combine_function [ \"time_point\" ] == \"Week 12\" ) & ( demo_combine_function [ \"ethnicity\" ] == \"Hispanic or Latino\" )][ \"PRPF6BT\" ], marker_color = '#2B6CBE' , opacity = 0.75 , nbinsx = 20 , showlegend = False ), row = 2 , col = 1 ) fig4 . add_trace ( go . Histogram ( x = demo_combine_function [( demo_combine_function [ \"time_point\" ] == \"Week 0\" ) & ( demo_combine_function [ \"ethnicity\" ] == \"Not Hispanic or Latino\" )][ \"PRPF6BT\" ], marker_color = '#EB89B5' , opacity = 0.75 , nbinsx = 20 , showlegend = False ), row = 2 , col = 2 ) fig4 . add_trace ( go . Histogram ( x = demo_combine_function [( demo_combine_function [ \"time_point\" ] == \"Week 12\" ) & ( demo_combine_function [ \"ethnicity\" ] == \"Not Hispanic or Latino\" )][ \"PRPF6BT\" ], marker_color = '#2B6CBE' , opacity = 0.75 , nbinsx = 20 , showlegend = False ), row = 2 , col = 2 ) fig4 . update_layout ( barmode = 'overlay' , width = 800 , height = 500 , legend_title_text = 'Time Point' ) fig4 . update_layout ( margin = dict ( l = 20 , r = 20 , t = 50 , b = 20 , pad = 2 )) fig4 . update_yaxes ( title_text = \"Count\" , title_font_size = 15 , range = [ 0 , 40 ], row = 1 , col = 1 ) fig4 . update_xaxes ( title_text = \"PROMIS-Physical Function 6b T-Score\" , title_font_size = 15 , range = [ 29 , 49 ], row = 1 , col = 1 ) fig4 . update_yaxes ( title_text = \"Count\" , title_font_size = 15 , range = [ 0 , 15 ], row = 2 , col = 1 ) fig4 . update_xaxes ( title_text = \"PROMIS-Physical Function 6b T-Score\" , title_font_size = 15 , range = [ 29 , 49 ], row = 2 , col = 1 ) fig4 . update_yaxes ( title_text = \"Count\" , title_font_size = 15 , range = [ 0 , 15 ], row = 2 , col = 2 ) fig4 . update_xaxes ( title_text = \"PROMIS-Physical Function 6b T-Score\" , title_font_size = 15 , range = [ 29 , 49 ], row = 2 , col = 2 ) fig4 . write_image ( 'img/BACPAC_Synthetic_Data_Analysis/figure4.png' ) Image ( filename = \"img/BACPAC_Synthetic_Data_Analysis/figure4.png\" )","title":"BACPAC Synthetic Data Analysis"},{"location":"notebooks/BACPAC_Synthetic_Data_Analysis/#bacpac-synthetic-data-analysis","text":"","title":"BACPAC Synthetic Data Analysis"},{"location":"notebooks/BACPAC_Synthetic_Data_Analysis/#qiong-liu","text":"","title":"Qiong Liu"},{"location":"notebooks/BACPAC_Synthetic_Data_Analysis/#april-2nd-2021","text":"In this Jupyter notebook, we used the BACPAC study as an example to demonstrate how to navigate datasets within the workspace in HEAL and conduct data analysis using Python libraries.","title":"April 2nd, 2021"},{"location":"notebooks/BACPAC_Synthetic_Data_Analysis/#table-of-content","text":"Set up notebook Pull file objects using the Gen3 SDK Demographic characteristics of participants in BACPAC Opiod pain medication profiling at two time points Physical function outcomes","title":"Table of Content"},{"location":"notebooks/BACPAC_Synthetic_Data_Analysis/#set-up-notebook","text":"# Uncomment the line to install python libraries by removing # ! pip install kaleido == 0.2.1 - q import pandas as pd import kaleido import plotly import plotly.graph_objects as go import plotly.express as px from plotly.subplots import make_subplots import plotly.io as pio from pathlib import Path import numpy as np import json import requests import os plotly . offline . init_notebook_mode () from IPython.display import Markdown , Image , display os . makedirs ( 'img/BACPAC_Synthetic_Data_Analysis' )","title":"Set up notebook"},{"location":"notebooks/BACPAC_Synthetic_Data_Analysis/#query-study-metadata","text":"Users can query study metadata in HEAL data commons using our metadata service (MDS). The cell below shows how to retrieve the metadata of the BACPAC study by interacting with the gen3 MDS endpoint. # Query the metadata of BACPAC using the project number \"1U24AR076730-01\" response = requests . get ( \"https://healdata.org/mds/metadata?data=True&limit=1000&gen3_discovery.project_number=1U24AR076730-01\" ) metadata_text = response . text metadata_object = json . loads ( metadata_text ) meta_df = pd . json_normalize ([ sub [ 'gen3_discovery' ] for sub in metadata_object . values () if 'gen3_discovery' in sub . keys ()]) Markdown ( meta_df [[ 'research_focus_area' , 'study_metadata.minimal_info.study_description' , 'institutions' ]] . transpose () . to_markdown ()) 0 research_focus_area Clinical Research in Pain Management study_metadata.minimal_info.study_description The BACPAC Research Programs Data Integration, Algorithm Development, and Operations Management Center (DAC) will bring cohesion to research performed by the participating Mechanistic Research Centers, Technology Research Sites, and Phase 2 Clinical Trials Centers. DAC Investigators will share their vision and provide scientific leadership and organizational support to the BACPAC Consortium. The research plan consists of supporting design and conduct of clinical trials with precision interventions that focus on identifying the best treatments for individual patients. The DAC will enhance collaboration and research progress with experienced leadership, innovative design and analysis methodologies, comprehensive research operations support, a state-of-the-art data management and integration system, and superior administrative support. This integrated structure will set the stage for technology assessments, solicitation of patient input and utilities, and the evaluation of high-impact interventions through the innovative design and sound execution of clinical trials, leading to effective personalized treatment approaches for patients with chronic lower back pain. institutions UNIV OF NORTH CAROLINA CHAPEL HILL","title":"Query study metadata"},{"location":"notebooks/BACPAC_Synthetic_Data_Analysis/#pull-file-objects-using-the-gen3-sdk","text":"! gen3 drs - pull object dg . H34L / 80 f0a338 - 18e0 - 48 de - b70f - cdabd63f67d9 ! gen3 drs - pull object dg . H34L / 530 fd95c - 48 b6 - 488 e - a699 - 9377180 bd82d ! gen3 drs - pull object dg . H34L / 654 d7f1f - b61c - 49 a9 - 8 a74 - c82400fa4c27 {\"succeeded\": [\"dg.H34L/80f0a338-18e0-48de-b70f-cdabd63f67d9\"], \"failed\": []} {\"succeeded\": [\"dg.H34L/530fd95c-48b6-488e-a699-9377180bd82d\"], \"failed\": []} {\"succeeded\": [\"dg.H34L/654d7f1f-b61c-49a9-8a74-c82400fa4c27\"], \"failed\": []}","title":"Pull file objects using the Gen3 SDK"},{"location":"notebooks/BACPAC_Synthetic_Data_Analysis/#demographic-characteristics-of-participants-in-bacpac","text":"# Read the demographic tsv file into dataframe demo_bacpac = pd . read_csv ( \"./participant_SMART.tsv\" , sep = \" \\t \" , encoding = \"utf-8\" ) # Define age groups within participants age_list = list ( demo_bacpac [ \"age_in_years\" ]) def age_group ( agelist ): min_age = min ( agelist ) grouplabel1 = str ( min_age ) + \"-55 yr\" grouplabel2 = \">55 yr\" grouplist = [] for i in agelist : if i <= 55 : grouplist . append ( grouplabel1 ) else : grouplist . append ( grouplabel2 ) return grouplist agegrouplist = age_group ( age_list ) demo_bacpac [ \"age_group\" ] = agegrouplist # Compute three frequency tables using demographic factors df1 = pd . crosstab ( index = demo_bacpac [ 'race' ], columns = demo_bacpac [ 'sex' ]) df2 = pd . crosstab ( index = demo_bacpac [ 'ethnicity' ], columns = demo_bacpac [ 'sex' ]) df3 = pd . crosstab ( index = demo_bacpac [ 'age_group' ], columns = demo_bacpac [ 'sex' ]) # Dsiplay concatenated tables Markdown ( pd . concat ([ df1 , df2 , df3 ], keys = [ 'race' , 'ethnicity' , 'age_group' ]) . to_markdown ()) Female Intersex Male Unknown ('race', 'American Indian or Alaska Native') 5 1 3 1 ('race', 'Asian') 2 0 3 0 ('race', 'Black or African American') 9 3 6 2 ('race', 'Multiple') 5 1 4 0 ('race', 'Native Hawaiian or Pacific Islander') 5 0 1 2 ('race', 'Not reported') 4 2 2 1 ('race', 'Unknown') 3 2 3 1 ('race', 'White') 37 4 26 12 ('ethnicity', 'Hispanic or Latino') 18 5 12 6 ('ethnicity', 'Not Hispanic or Latino') 36 4 27 6 ('ethnicity', 'Not reported') 7 1 4 4 ('ethnicity', 'Unknown') 9 3 5 3 ('age_group', '20-55 yr') 42 9 29 14 ('age_group', '>55 yr') 28 4 19 5 # Generate a stacked bar chart of participants in BACPAC new_df2 = pd . DataFrame ( df2 . stack ()) new_df2 . reset_index ( inplace = True ) new_df2 = new_df2 . rename ({ 0 : \"Count\" , \"sex\" : \"Sex\" , \"ethnicity\" : \"Ethnicity\" }, axis = \"columns\" ) fig = go . Figure () fig = px . bar ( new_df2 , x = \"Sex\" , y = \"Count\" , color = \"Ethnicity\" , title = \"Ethnicity and Sex Characteristics of Participants in the BACPAC Study\" , width = 800 , height = 500 ) fig . write_image ( 'img/BACPAC/figure1.png' ) Image ( filename = \"img/BACPAC_Synthetic_Data_Analysis/figure1.png\" )","title":"Demographic characteristics of participants in BACPAC"},{"location":"notebooks/BACPAC_Synthetic_Data_Analysis/#opiod-pain-medication-profiling-at-two-time-points","text":"# Read substance use tsv file into dataframe substance_df = pd . read_csv ( \"./substance_use_SMART.tsv\" , sep = \" \\t \" , encoding = \"utf-8\" ) # Combine substance use df and demographic df based on participant id def find_participant ( mydf , endstr ): participant_id = [] for i in list ( mydf [ \"submitter_id\" ]): i_participant = i . rstrip ( endstr ) participant_id . append ( i_participant ) return participant_id substance_participant_id = find_participant ( substance_df , \"_sc\" ) substance_df [ \"participant_id\" ] = substance_participant_id demo_combine_substance = substance_df . merge ( demo_bacpac , left_on = \"participant_id\" , right_on = \"submitter_id\" , how = \"outer\" ) # Add one property of time point in the df def find_timepoint ( mydf ): timepoint = [] for i in list ( mydf [ \"visits.submitter_id\" ]): if i . endswith ( \"Week 0\" ): timepoint . append ( \"Week 0\" ) else : timepoint . append ( \"Week 12\" ) return timepoint demo_combine_substance [ \"time_point\" ] = find_timepoint ( demo_combine_substance ) # Compute a frequency table using opioid medication factor and time point factor opioid_crosstab = pd . crosstab ( index = demo_combine_substance [ 'OPIOID01' ], columns = demo_combine_substance [ 'time_point' ]) new_opioid = pd . DataFrame ( opioid_crosstab . stack ()) new_opioid . reset_index ( inplace = True ) new_opioid = new_opioid . rename ({ 0 : \"Count\" , \"OPIOID01\" : \"Taking Opioid\" , \"time_point\" : \"Time Point\" }, axis = \"columns\" ) fig2 = go . Figure () fig2 = px . bar ( new_opioid , x = \"Taking Opioid\" , y = \"Count\" , color = \"Taking Opioid\" , facet_row = \"Time Point\" , width = 800 , height = 400 ) fig2 . update_layout ( title_text = \"Self-Report of Opioid Pain Medication Use at Baseline and Twelve Weeks\" , title_font_size = 20 ) for data in fig2 . data : data [ \"width\" ] = 0.6 fig2 . write_image ( 'img/BACPAC_Synthetic_Data_Analysis/figure2.png' ) Image ( filename = \"img/BACPAC_Synthetic_Data_Analysis/figure2.png\" ) We observed an increase of participants taking opioid pain medication at the week 12 time point compared to baseline. # Generate a bar chart showing the opioid taking at two time points in different sex groups opioid_gender = pd . crosstab ( index = [ demo_combine_substance [ 'OPIOID01' ], demo_combine_substance [ 'sex' ]], columns = demo_combine_substance [ 'time_point' ]) new_opioid_gender = pd . DataFrame ( opioid_gender . stack ()) new_opioid_gender . reset_index ( inplace = True ) new_opioid_gender = new_opioid_gender . rename ({ 0 : \"Count\" , \"OPIOID01\" : \"Taking Opioid\" , \"time_point\" : \"Time Point\" , \"sex\" : \"Sex\" }, axis = \"columns\" ) fig3 = go . Figure () fig3 = px . bar ( new_opioid_gender , y = \"Sex\" , x = \"Count\" , color = \"Taking Opioid\" , facet_col = \"Time Point\" , width = 800 , height = 400 , orientation = 'h' , category_orders = { \"Sex\" : [ \"Intersex\" , \"Unknown\" , \"Male\" , \"Female\" ]}) fig3 . update_layout ( title_text = \"Opioid Pain Medication at Two Time Points in Different Sex Groups\" , title_font_size = 20 ) fig3 . write_image ( 'img/BACPAC_Synthetic_Data_Analysis/figure3.png' ) Image ( filename = \"img/BACPAC_Synthetic_Data_Analysis/figure3.png\" ) We observed an increase of particpants taking opioid medication at week 12 in both male and femal groups compared to baseline week 0.","title":"Opiod pain medication profiling at two time points"},{"location":"notebooks/BACPAC_Synthetic_Data_Analysis/#physical-function-outcomes","text":"The cell below uses the Physical Function 6b T-Score to display physical function outcomes in different ethnicity groups at week 0 and week 12. # Read physical_function_SMART.tsv into dataframe and merge the df with demographic function_df = pd . read_csv ( \"./physical_function_SMART.tsv\" , sep = \" \\t \" , encoding = \"utf-16\" ) function_participant_id = find_participant ( function_df , \"_pf\" ) function_df [ \"participant_id\" ] = function_participant_id demo_combine_function = function_df . merge ( demo_bacpac , left_on = \"participant_id\" , right_on = \"submitter_id\" , how = \"outer\" ) demo_combine_function [ \"time_point\" ] = find_timepoint ( demo_combine_function ) # Summary table of ROMIS-Physical Function 6b T-Score in different ethnicity groups ethnicity_PRPF6BT = demo_combine_function [[ \"time_point\" , \"PRPF6BT\" , \"ethnicity\" ]] . groupby ([ 'time_point' , 'ethnicity' ]) . describe () Markdown ( ethnicity_PRPF6BT . to_markdown ()) ('PRPF6BT', 'count') ('PRPF6BT', 'mean') ('PRPF6BT', 'std') ('PRPF6BT', 'min') ('PRPF6BT', '25%') ('PRPF6BT', '50%') ('PRPF6BT', '75%') ('PRPF6BT', 'max') ('Week 0', 'Hispanic or Latino') 41 38.2854 3.16501 32.5 36 38.5 39.3 48.7 ('Week 0', 'Not Hispanic or Latino') 73 37.5411 2.59823 31.5 35.1 37.6 39.3 44.2 ('Week 0', 'Not reported') 16 37.6125 2.93754 33.4 35.1 38.05 40.2 43.1 ('Week 0', 'Unknown') 20 38.195 2.46736 31.5 37.4 38.5 39.3 42.1 ('Week 12', 'Hispanic or Latino') 41 37.5366 3.06299 29.1 35.1 37.6 39.3 43.1 ('Week 12', 'Not Hispanic or Latino') 73 37.589 3.24267 31.5 35.1 37.6 40.2 44.2 ('Week 12', 'Not reported') 16 37.7438 2.74007 33.4 36 36.8 39.525 43.1 ('Week 12', 'Unknown') 20 36.925 3.26366 29.1 35.1 36 38.7 44.2 # Visualize the distribution of Physical Function 6b T-Score # at two time points for hispanic and non-hispanic ethnicity groups fig4 = go . Figure () fig4 = make_subplots ( rows = 2 , cols = 2 , specs = [[{ \"colspan\" : 2 }, None ], [{}, {}]], subplot_titles = ( \"PROMIS-Physical Function 6b T-Score Distribution at Two Time Points\" , \"Hispanic or Latino\" , \"Not Hispanic or Latino\" )) fig4 . add_trace ( go . Histogram ( x = demo_combine_function [ demo_combine_function [ \"time_point\" ] == \"Week 0\" ][ \"PRPF6BT\" ], marker_color = '#EB89B5' , opacity = 0.75 , nbinsx = 20 , name = \"Week 0\" ), row = 1 , col = 1 ) fig4 . add_trace ( go . Histogram ( x = demo_combine_function [ demo_combine_function [ \"time_point\" ] == \"Week 12\" ][ \"PRPF6BT\" ], marker_color = '#2B6CBE' , opacity = 0.75 , nbinsx = 20 , name = \"Week 12\" ), row = 1 , col = 1 ) fig4 . add_trace ( go . Histogram ( x = demo_combine_function [( demo_combine_function [ \"time_point\" ] == \"Week 0\" ) & ( demo_combine_function [ \"ethnicity\" ] == \"Hispanic or Latino\" )][ \"PRPF6BT\" ], marker_color = '#EB89B5' , opacity = 0.75 , nbinsx = 20 , showlegend = False ), row = 2 , col = 1 ) fig4 . add_trace ( go . Histogram ( x = demo_combine_function [( demo_combine_function [ \"time_point\" ] == \"Week 12\" ) & ( demo_combine_function [ \"ethnicity\" ] == \"Hispanic or Latino\" )][ \"PRPF6BT\" ], marker_color = '#2B6CBE' , opacity = 0.75 , nbinsx = 20 , showlegend = False ), row = 2 , col = 1 ) fig4 . add_trace ( go . Histogram ( x = demo_combine_function [( demo_combine_function [ \"time_point\" ] == \"Week 0\" ) & ( demo_combine_function [ \"ethnicity\" ] == \"Not Hispanic or Latino\" )][ \"PRPF6BT\" ], marker_color = '#EB89B5' , opacity = 0.75 , nbinsx = 20 , showlegend = False ), row = 2 , col = 2 ) fig4 . add_trace ( go . Histogram ( x = demo_combine_function [( demo_combine_function [ \"time_point\" ] == \"Week 12\" ) & ( demo_combine_function [ \"ethnicity\" ] == \"Not Hispanic or Latino\" )][ \"PRPF6BT\" ], marker_color = '#2B6CBE' , opacity = 0.75 , nbinsx = 20 , showlegend = False ), row = 2 , col = 2 ) fig4 . update_layout ( barmode = 'overlay' , width = 800 , height = 500 , legend_title_text = 'Time Point' ) fig4 . update_layout ( margin = dict ( l = 20 , r = 20 , t = 50 , b = 20 , pad = 2 )) fig4 . update_yaxes ( title_text = \"Count\" , title_font_size = 15 , range = [ 0 , 40 ], row = 1 , col = 1 ) fig4 . update_xaxes ( title_text = \"PROMIS-Physical Function 6b T-Score\" , title_font_size = 15 , range = [ 29 , 49 ], row = 1 , col = 1 ) fig4 . update_yaxes ( title_text = \"Count\" , title_font_size = 15 , range = [ 0 , 15 ], row = 2 , col = 1 ) fig4 . update_xaxes ( title_text = \"PROMIS-Physical Function 6b T-Score\" , title_font_size = 15 , range = [ 29 , 49 ], row = 2 , col = 1 ) fig4 . update_yaxes ( title_text = \"Count\" , title_font_size = 15 , range = [ 0 , 15 ], row = 2 , col = 2 ) fig4 . update_xaxes ( title_text = \"PROMIS-Physical Function 6b T-Score\" , title_font_size = 15 , range = [ 29 , 49 ], row = 2 , col = 2 ) fig4 . write_image ( 'img/BACPAC_Synthetic_Data_Analysis/figure4.png' ) Image ( filename = \"img/BACPAC_Synthetic_Data_Analysis/figure4.png\" )","title":"Physical function outcomes"},{"location":"notebooks/Opioid_Risk_Metric_Threshold_Identification-Study_Recreation/","text":"Opioid Risk Metric Threshold Identification - Study Recreation \u00b6 - J M. Maxwell \u00b6 In this notebook we will be recreating the work by Cochran et al. from the paper Validation and Threshold Identification of a Prescription Drug Monitoring Program Clinical Opioid Risk Metric with the WHO Alcohol, Smoking, and Substance Involvement Screening Test . We will be utilizing data from the study Validation of a Community Pharmacy-Based Prescription Drug Monitoring Program Risk Screening Tool to recreate a number of the images and graphs as seen in the paper. This work was strictly done to demonstrate the advantages of the HEAL Platform's Workspace feature and the ability to utilize data that is joined under the HEAL data mesh. While all the work here was completed by J M. Maxwell and members of the HEAL Platform team, this is not original work, and it is exclusively based off of the work completed by Cochran et al. Due to compounding factors relating to variations in data cleaning methodologies, the work presented here will slightly vary from the results published in Validation and Threshold Identification... by Cochran et al. The work here does not represent the official opinions, recommendations, or conclusions of Cochran et al. and this work does not represent policy or medical recommendations on behalf of the NIH HEAL Initiative, The Center For Translational Data Science, or The University of Chicago. Access Data \u00b6 To access the data from this study make sure you are logged in to the InCommon login option and then: 1) Go to the HEAL discovery page to select the study 2) Select the 'Open In Workspace' option and choose the (Tutorials) Example Analysis Jupyter Lab Notebooks workspace option 3) Use the exported study manifest to download the study. Otherwise you may run the follwowing gen3-sdk command to download the relevant CSV file from the study. ! gen3 drs - pull object dg . H34L / f3de0abd - 5338 - 4 b42 - 8689 - 04 dfc46a6dbb {\"succeeded\": [\"dg.H34L/f3de0abd-5338-4b42-8689-04dfc46a6dbb\"], \"failed\": []} Introduction \u00b6 The Prescription Drug Monitoring Program (PDMP) is a highly available tool pharmacists may use to identify patients who are potentially misusing or abusing opioids. However, in practice, mixed results have been achieved in the application of PDMP to improve opioid safety. The output of PDMP information that pharmacists have access to is often un-summarized and of limited clinical value. Appriss Health has developed the Narcotic Score (NS) metric, a novel opioid risk identification metric, with the hope of offering to community pharmacists a clinical metric for identifying subjects with a high risk of opioid misuse and guidelines for promoting response and resources to those high risk individuals. Methods \u00b6 In their paper, Cochran et al. describe how the NS metric, composed of a collection of survey responses, is a continuous scale from 000-999; the first two numbers are a composite risk score derived from a collection of well known risk indicators and the third number is the total number of active opioid prescriptions (coded 0-9+). They compared and scaled the NS metric to the WHO Alcohol, Smoking, and Substance Involvement Screening Test (ASSIST), which is considered a gold-standard for assessing drug use risk. They then calculated the risk threshold identifications using the ASSIST prescription opioid subscale and all participants were sorted into one of three risk categories - low, moderate, and high. Data Preprocessing \u00b6 ! pip install matplotlib - q ! pip install scikit_learn - q import pandas as pd import numpy as np import os import matplotlib.pyplot as plt import matplotlib.image as mpimg from sklearn import metrics from zipfile import ZipFile from IPython.display import Markdown , Image , display os . makedirs ( 'img/Opioid_Risk_Metric_Threshold_Identification' ) Read Data \u00b6 Read in the data and filter by the relevant data fields: Unique Identifier, Narcotic Score, and ASSIST prescription opioid subscale responses. with ZipFile ( 'CTN0093_csv.zip' , 'r' ) as zip_object : zip_object . extractall () df = pd . read_csv ( 'CTN0093_FINAL_DATASET.csv' ) cols = [ x for x in df . columns if 'RX_OPIOID' in x ] df = df [[ 'ID' , 'NARCOTICSCORE' ] + cols ] . copy () Markdown ( df . head () . to_markdown ()) ID NARCOTICSCORE ASSIST_EVER_RX_OPIOID ASSIST_3MONTH_RX_OPIOID ASSIST_DESIRE_RX_OPIOID ASSIST_ISSUES_RX_OPIOID ASSIST_FAILED_RX_OPIOID ASSIST_WORRY_RX_OPIOID ASSIST_NO_CURB_RX_OPIOID 0 175702 341 3 6 0 0 0 0 0 1 958356 120 3 4 0 0 0 0 0 2 280698 451 3 6 6 0 0 0 0 3 324612 381 3 2 0 0 0 0 0 4 453755 321 0 nan nan nan nan nan nan Clean Data \u00b6 Map fields from string to integer values, remove observations with missing ASSIST responses, and replace missing values. df = df [ df . NARCOTICSCORE != 'Not in Appriss Database' ] . copy () df . NARCOTICSCORE = df . NARCOTICSCORE . astype ( int ) df = df [ df . ASSIST_EVER_RX_OPIOID != 999 ] . copy () df . replace ( np . nan , 0 , inplace = True ) Calculate ASSIST Risk Levels \u00b6 From their paper, Cochran et al., use the ASSIST prescription opioid risk subscale questionnaire to map subjects to their respective prescription opioid risk levels and remove subjects with incomplete questionnaire responses. assist_score = ( df . ASSIST_3MONTH_RX_OPIOID + df . ASSIST_DESIRE_RX_OPIOID + df . ASSIST_ISSUES_RX_OPIOID + df . ASSIST_FAILED_RX_OPIOID + df . ASSIST_WORRY_RX_OPIOID + df . ASSIST_NO_CURB_RX_OPIOID ) df [ 'ASSIST_SCORE' ] = assist_score df = df [ df . ASSIST_SCORE < 999 ] df [ 'ASSIST_LOW' ] = ( df . ASSIST_SCORE <= 3 ) df [ 'ASSIST_MEDIUM' ] = (( 4 <= df . ASSIST_SCORE ) & ( df . ASSIST_SCORE <= 26 )) df [ 'ASSIST_HIGH' ] = ( 27 <= df . ASSIST_SCORE ) print ( f \"\"\"Number of subjects with ASSIST low risk: { sum ( df [ 'ASSIST_LOW' ]) } \\n Number of subjects with ASSIST moderate risk: { sum ( df [ 'ASSIST_MEDIUM' ]) } \\n Number of subjects with ASSIST high risk: { sum ( df [ 'ASSIST_HIGH' ]) } \\n \"\"\" ) Number of subjects with ASSIST low risk: 772 Number of subjects with ASSIST moderate risk: 623 Number of subjects with ASSIST high risk: 33 Calculate Narcotic Score Risk Levels \u00b6 Cochran et al. applied grid search cross validation to select the risk thresholds by finding the NS metrics that gave the lowest average misclassification rate when segmenting low vs. medium and high risk and high vs. low and medium risk. The threshold for high risk individuals was a score of 602 and for low risk individuals was 291. df [ 'NS_LOW' ] = ( df . NARCOTICSCORE <= 291 ) df [ 'NS_MEDIUM' ] = (( 291 < df . NARCOTICSCORE ) & ( df . NARCOTICSCORE < 602 )) df [ 'NS_HIGH' ] = ( 602 < df . NARCOTICSCORE ) print ( f \"\"\"Number of subjects with NS low risk: { sum ( df [ 'NS_LOW' ]) } \\n Number of subjects with NS moderate risk: { sum ( df [ 'NS_MEDIUM' ]) } \\n Number of subjects with NS high risk: { sum ( df [ 'NS_HIGH' ]) } \\n \"\"\" ) Number of subjects with NS low risk: 733 Number of subjects with NS moderate risk: 689 Number of subjects with NS high risk: 6 Discriminating Validity of the NS metric \u00b6 They applied receiver operating characteristic (ROC) analysis to the ability to seperate high and moderate risk subjects and moderate and low risk subjects on the ASSIST subscale for prescription opioids using the NS metric. This application demonstrated to be reasonably successful. ns_metrics = df . NARCOTICSCORE . sort_values () . unique () y_high = df . ASSIST_HIGH y_low = df . ASSIST_LOW sensitivity_high = np . ones ( len ( ns_metrics )) specificity_high = np . ones ( len ( ns_metrics )) sensitivity_low = np . ones ( len ( ns_metrics )) specificity_low = np . ones ( len ( ns_metrics )) for i in range ( 0 , len ( ns_metrics )): y_pred_high = 1 * ( df . NARCOTICSCORE > ns_metrics [ i ]) y_pred_low = 1 * ( df . NARCOTICSCORE <= ns_metrics [ i ]) sensitivity_low [ i ] = sum ( y_low * y_pred_low ) / ( sum ( y_low * y_pred_low ) + sum ( - 1 * ( y_low ) * ( y_pred_low - 1 ))) specificity_low [ i ] = sum (( y_low - 1 ) * ( y_pred_low - 1 )) / ( sum (( y_low - 1 ) * ( y_pred_low - 1 )) + sum ( - 1 * ( y_low - 1 ) * ( y_pred_low ))) sensitivity_high [ i ] = sum ( y_high * y_pred_high ) / ( sum ( y_high * y_pred_high ) + sum ( - 1 * ( y_high ) * ( y_pred_high - 1 ))) specificity_high [ i ] = sum (( y_high - 1 ) * ( y_pred_high - 1 )) / ( sum (( y_high - 1 ) * ( y_pred_high - 1 )) + sum ( - 1 * ( y_high - 1 ) * ( y_pred_high ))) fig = plt . figure () plt . plot ( 1 - specificity_high , sensitivity_high ) plt . plot ( 1 - specificity_low , sensitivity_low ) high_auc = metrics . auc ( 1 - specificity_high , sensitivity_high ) low_auc = metrics . auc ( 1 - specificity_low , sensitivity_low ) plt . grid () plt . legend ([ f 'Moderate-High Risk Determination \\n AUC = { round ( high_auc , 2 ) } ' , f 'Low-Moderate Risk Determination \\n AUC = { round ( low_auc , 2 ) } ' ]) plt . title ( 'ROC curve for Narcotic Score Discriminating High vs. \\n Moderate risk and Moderate vs. Low risk Prescription Opioid Use' ) fig . savefig ( 'img/Opioid_Risk_Metric_Threshold_Identification/figure1.png' ) plt . close () Image ( filename = 'img/Opioid_Risk_Metric_Threshold_Identification/figure1.png' ) Risk Threshold Scores \u00b6 They next measured the agreement betwen the NS metric risk thresholds and the ASSIST score established risk thresholds using a confusion matrix below. Approximately 67.2% of the subjects were accurately mapped to the appropriate risk threshold using the NS metric, 17.0% of the participant classifications are false positives and the remaining 15.8% are false negatives. x = pd . DataFrame ( np . array ((( sum (( df . ASSIST_LOW == 1 ) & ( df . NS_LOW == 1 )), sum (( df . ASSIST_MEDIUM == 1 ) & ( df . NS_LOW == 1 )), sum (( df . ASSIST_HIGH == 1 ) & ( df . NS_LOW == 1 ))), ( sum (( df . ASSIST_LOW == 1 ) & ( df . NS_MEDIUM == 1 )), sum (( df . ASSIST_MEDIUM == 1 ) & ( df . NS_MEDIUM == 1 )), sum (( df . ASSIST_HIGH == 1 ) & ( df . NS_MEDIUM == 1 ))), ( sum (( df . ASSIST_LOW == 1 ) & ( df . NS_HIGH == 1 )), sum (( df . ASSIST_MEDIUM == 1 ) & ( df . NS_HIGH == 1 )), sum (( df . ASSIST_HIGH == 1 ) & ( df . NS_HIGH == 1 ))), ))) x . rename ( columns = { 0 : 'ASSIT Low Risk' , 1 : 'ASSIT Moderate Risk' , 2 : 'ASSIT High Risk' }, index = { 0 : 'NS Low Risk' , 1 : 'NS Moderate Risk' , 2 : 'NS High Risk' }, inplace = True ) table = x . astype ( str ) + ' - ' + ( 100 * x / x . sum () . sum ()) . round ( 1 ) . astype ( str ) + '%' Markdown ( table . to_markdown ()) ASSIT Low Risk ASSIT Moderate Risk ASSIT High Risk NS Low Risk 532 - 37.3% 194 - 13.6% 7 - 0.5% NS Moderate Risk 239 - 16.7% 426 - 29.8% 24 - 1.7% NS High Risk 1 - 0.1% 3 - 0.2% 2 - 0.1% Discussion And Conclusions \u00b6 Cochran et al. argue that the accuracy of the NS metric in segmenting subjects by their opioid risk demonstrates that the NS metric is a fair screening tool for detecting risky prescription opioid use. Additionally, combining the number of correctly identified risk profiles with the number of subjects who have high opioid use but low reported risk (those subjects likely needing additional screening), the NS metric provides a meaningful level (86%) of clinically useful and actionable information. Cochran et al. argue that this high rate of accurate, clinically actionable insights would suggest that the NS metric may have an impactful role as a \"universal screen\" because of its high availability to community pharmacists and physicians and its relatively low barriers of use. They beleive that inn application, after pharmacists or clinicians receive a subject's NS metric, the pharmacists or clinicians may use the scores to triage subjects based on their respective risk profiles. If subjects are of moderate or high risk, as determined by their Narcotic Score, pharmacists may then use a decision support tool like the Prescription Drug Monitoring Clinical Decision Support Tool to assess which further risk assessment tools and patient recommendations to make. According to the paper, false positive misclassification is greatest among subjects with significant outlying factors to their pain management or prescription opioid use, such as disability or generally poor health. If the NS metric is applied in clinical practice, these false positive classifications would require further patient screening to rule out risks of opioid misuse and to allow pharmacists and clinicians to recommend additional pain management solutions. The study from Cochran et al. explains how the NS metric can be used as a universal screening tool for prescription opioid misuse risk by clinicians and pharmacists at the community level. In particular, the NS metric offers an easy-to-use format for identifying risky subject profiles with minimal effort required from either the subject or the pharmacist, and utilization of the NS metric is well positioned to inform decision-making by pharmacists and to compliment existing surveys for assessing subjects' risks of prescription opioid misuse. References \u00b6 Paper \u00b6 Cochran G, Brown J, Yu Z, Frede S, Bryan MA, Ferguson A, Bayyari N, Taylor B, Snyder ME, Charron E, Adeoye-Olatunde OA, Ghitza UE, Winhusen T. Validation and threshold identification of a prescription drug monitoring program clinical opioid risk metric with the WHO alcohol, smoking, and substance involvement screening test. Drug Alcohol Depend. 2021 Nov 1;228:109067. doi: 10.1016/j.drugalcdep.2021.109067. Epub 2021 Sep 24. PMID: 34610516; PMCID: PMC8612015. Study \u00b6 Cochran G, Winhusen T. Validation of a Community Pharmacy-Based Prescription Drug Monitoring Program Risk Screening Tool. NIDA-CTN-0093. https://datashare.nida.nih.gov/study/nida-ctn-0093","title":"Opioid Risk Metric Threshold Identification - Study Recreation"},{"location":"notebooks/Opioid_Risk_Metric_Threshold_Identification-Study_Recreation/#opioid-risk-metric-threshold-identification-study-recreation","text":"","title":"Opioid Risk Metric Threshold Identification - Study Recreation"},{"location":"notebooks/Opioid_Risk_Metric_Threshold_Identification-Study_Recreation/#-j-m-maxwell","text":"In this notebook we will be recreating the work by Cochran et al. from the paper Validation and Threshold Identification of a Prescription Drug Monitoring Program Clinical Opioid Risk Metric with the WHO Alcohol, Smoking, and Substance Involvement Screening Test . We will be utilizing data from the study Validation of a Community Pharmacy-Based Prescription Drug Monitoring Program Risk Screening Tool to recreate a number of the images and graphs as seen in the paper. This work was strictly done to demonstrate the advantages of the HEAL Platform's Workspace feature and the ability to utilize data that is joined under the HEAL data mesh. While all the work here was completed by J M. Maxwell and members of the HEAL Platform team, this is not original work, and it is exclusively based off of the work completed by Cochran et al. Due to compounding factors relating to variations in data cleaning methodologies, the work presented here will slightly vary from the results published in Validation and Threshold Identification... by Cochran et al. The work here does not represent the official opinions, recommendations, or conclusions of Cochran et al. and this work does not represent policy or medical recommendations on behalf of the NIH HEAL Initiative, The Center For Translational Data Science, or The University of Chicago.","title":"- J M. Maxwell"},{"location":"notebooks/Opioid_Risk_Metric_Threshold_Identification-Study_Recreation/#access-data","text":"To access the data from this study make sure you are logged in to the InCommon login option and then: 1) Go to the HEAL discovery page to select the study 2) Select the 'Open In Workspace' option and choose the (Tutorials) Example Analysis Jupyter Lab Notebooks workspace option 3) Use the exported study manifest to download the study. Otherwise you may run the follwowing gen3-sdk command to download the relevant CSV file from the study. ! gen3 drs - pull object dg . H34L / f3de0abd - 5338 - 4 b42 - 8689 - 04 dfc46a6dbb {\"succeeded\": [\"dg.H34L/f3de0abd-5338-4b42-8689-04dfc46a6dbb\"], \"failed\": []}","title":"Access Data"},{"location":"notebooks/Opioid_Risk_Metric_Threshold_Identification-Study_Recreation/#introduction","text":"The Prescription Drug Monitoring Program (PDMP) is a highly available tool pharmacists may use to identify patients who are potentially misusing or abusing opioids. However, in practice, mixed results have been achieved in the application of PDMP to improve opioid safety. The output of PDMP information that pharmacists have access to is often un-summarized and of limited clinical value. Appriss Health has developed the Narcotic Score (NS) metric, a novel opioid risk identification metric, with the hope of offering to community pharmacists a clinical metric for identifying subjects with a high risk of opioid misuse and guidelines for promoting response and resources to those high risk individuals.","title":"Introduction"},{"location":"notebooks/Opioid_Risk_Metric_Threshold_Identification-Study_Recreation/#methods","text":"In their paper, Cochran et al. describe how the NS metric, composed of a collection of survey responses, is a continuous scale from 000-999; the first two numbers are a composite risk score derived from a collection of well known risk indicators and the third number is the total number of active opioid prescriptions (coded 0-9+). They compared and scaled the NS metric to the WHO Alcohol, Smoking, and Substance Involvement Screening Test (ASSIST), which is considered a gold-standard for assessing drug use risk. They then calculated the risk threshold identifications using the ASSIST prescription opioid subscale and all participants were sorted into one of three risk categories - low, moderate, and high.","title":"Methods"},{"location":"notebooks/Opioid_Risk_Metric_Threshold_Identification-Study_Recreation/#data-preprocessing","text":"! pip install matplotlib - q ! pip install scikit_learn - q import pandas as pd import numpy as np import os import matplotlib.pyplot as plt import matplotlib.image as mpimg from sklearn import metrics from zipfile import ZipFile from IPython.display import Markdown , Image , display os . makedirs ( 'img/Opioid_Risk_Metric_Threshold_Identification' )","title":"Data Preprocessing"},{"location":"notebooks/Opioid_Risk_Metric_Threshold_Identification-Study_Recreation/#read-data","text":"Read in the data and filter by the relevant data fields: Unique Identifier, Narcotic Score, and ASSIST prescription opioid subscale responses. with ZipFile ( 'CTN0093_csv.zip' , 'r' ) as zip_object : zip_object . extractall () df = pd . read_csv ( 'CTN0093_FINAL_DATASET.csv' ) cols = [ x for x in df . columns if 'RX_OPIOID' in x ] df = df [[ 'ID' , 'NARCOTICSCORE' ] + cols ] . copy () Markdown ( df . head () . to_markdown ()) ID NARCOTICSCORE ASSIST_EVER_RX_OPIOID ASSIST_3MONTH_RX_OPIOID ASSIST_DESIRE_RX_OPIOID ASSIST_ISSUES_RX_OPIOID ASSIST_FAILED_RX_OPIOID ASSIST_WORRY_RX_OPIOID ASSIST_NO_CURB_RX_OPIOID 0 175702 341 3 6 0 0 0 0 0 1 958356 120 3 4 0 0 0 0 0 2 280698 451 3 6 6 0 0 0 0 3 324612 381 3 2 0 0 0 0 0 4 453755 321 0 nan nan nan nan nan nan","title":"Read Data"},{"location":"notebooks/Opioid_Risk_Metric_Threshold_Identification-Study_Recreation/#clean-data","text":"Map fields from string to integer values, remove observations with missing ASSIST responses, and replace missing values. df = df [ df . NARCOTICSCORE != 'Not in Appriss Database' ] . copy () df . NARCOTICSCORE = df . NARCOTICSCORE . astype ( int ) df = df [ df . ASSIST_EVER_RX_OPIOID != 999 ] . copy () df . replace ( np . nan , 0 , inplace = True )","title":"Clean Data"},{"location":"notebooks/Opioid_Risk_Metric_Threshold_Identification-Study_Recreation/#calculate-assist-risk-levels","text":"From their paper, Cochran et al., use the ASSIST prescription opioid risk subscale questionnaire to map subjects to their respective prescription opioid risk levels and remove subjects with incomplete questionnaire responses. assist_score = ( df . ASSIST_3MONTH_RX_OPIOID + df . ASSIST_DESIRE_RX_OPIOID + df . ASSIST_ISSUES_RX_OPIOID + df . ASSIST_FAILED_RX_OPIOID + df . ASSIST_WORRY_RX_OPIOID + df . ASSIST_NO_CURB_RX_OPIOID ) df [ 'ASSIST_SCORE' ] = assist_score df = df [ df . ASSIST_SCORE < 999 ] df [ 'ASSIST_LOW' ] = ( df . ASSIST_SCORE <= 3 ) df [ 'ASSIST_MEDIUM' ] = (( 4 <= df . ASSIST_SCORE ) & ( df . ASSIST_SCORE <= 26 )) df [ 'ASSIST_HIGH' ] = ( 27 <= df . ASSIST_SCORE ) print ( f \"\"\"Number of subjects with ASSIST low risk: { sum ( df [ 'ASSIST_LOW' ]) } \\n Number of subjects with ASSIST moderate risk: { sum ( df [ 'ASSIST_MEDIUM' ]) } \\n Number of subjects with ASSIST high risk: { sum ( df [ 'ASSIST_HIGH' ]) } \\n \"\"\" ) Number of subjects with ASSIST low risk: 772 Number of subjects with ASSIST moderate risk: 623 Number of subjects with ASSIST high risk: 33","title":"Calculate ASSIST Risk Levels"},{"location":"notebooks/Opioid_Risk_Metric_Threshold_Identification-Study_Recreation/#calculate-narcotic-score-risk-levels","text":"Cochran et al. applied grid search cross validation to select the risk thresholds by finding the NS metrics that gave the lowest average misclassification rate when segmenting low vs. medium and high risk and high vs. low and medium risk. The threshold for high risk individuals was a score of 602 and for low risk individuals was 291. df [ 'NS_LOW' ] = ( df . NARCOTICSCORE <= 291 ) df [ 'NS_MEDIUM' ] = (( 291 < df . NARCOTICSCORE ) & ( df . NARCOTICSCORE < 602 )) df [ 'NS_HIGH' ] = ( 602 < df . NARCOTICSCORE ) print ( f \"\"\"Number of subjects with NS low risk: { sum ( df [ 'NS_LOW' ]) } \\n Number of subjects with NS moderate risk: { sum ( df [ 'NS_MEDIUM' ]) } \\n Number of subjects with NS high risk: { sum ( df [ 'NS_HIGH' ]) } \\n \"\"\" ) Number of subjects with NS low risk: 733 Number of subjects with NS moderate risk: 689 Number of subjects with NS high risk: 6","title":"Calculate Narcotic Score Risk Levels"},{"location":"notebooks/Opioid_Risk_Metric_Threshold_Identification-Study_Recreation/#discriminating-validity-of-the-ns-metric","text":"They applied receiver operating characteristic (ROC) analysis to the ability to seperate high and moderate risk subjects and moderate and low risk subjects on the ASSIST subscale for prescription opioids using the NS metric. This application demonstrated to be reasonably successful. ns_metrics = df . NARCOTICSCORE . sort_values () . unique () y_high = df . ASSIST_HIGH y_low = df . ASSIST_LOW sensitivity_high = np . ones ( len ( ns_metrics )) specificity_high = np . ones ( len ( ns_metrics )) sensitivity_low = np . ones ( len ( ns_metrics )) specificity_low = np . ones ( len ( ns_metrics )) for i in range ( 0 , len ( ns_metrics )): y_pred_high = 1 * ( df . NARCOTICSCORE > ns_metrics [ i ]) y_pred_low = 1 * ( df . NARCOTICSCORE <= ns_metrics [ i ]) sensitivity_low [ i ] = sum ( y_low * y_pred_low ) / ( sum ( y_low * y_pred_low ) + sum ( - 1 * ( y_low ) * ( y_pred_low - 1 ))) specificity_low [ i ] = sum (( y_low - 1 ) * ( y_pred_low - 1 )) / ( sum (( y_low - 1 ) * ( y_pred_low - 1 )) + sum ( - 1 * ( y_low - 1 ) * ( y_pred_low ))) sensitivity_high [ i ] = sum ( y_high * y_pred_high ) / ( sum ( y_high * y_pred_high ) + sum ( - 1 * ( y_high ) * ( y_pred_high - 1 ))) specificity_high [ i ] = sum (( y_high - 1 ) * ( y_pred_high - 1 )) / ( sum (( y_high - 1 ) * ( y_pred_high - 1 )) + sum ( - 1 * ( y_high - 1 ) * ( y_pred_high ))) fig = plt . figure () plt . plot ( 1 - specificity_high , sensitivity_high ) plt . plot ( 1 - specificity_low , sensitivity_low ) high_auc = metrics . auc ( 1 - specificity_high , sensitivity_high ) low_auc = metrics . auc ( 1 - specificity_low , sensitivity_low ) plt . grid () plt . legend ([ f 'Moderate-High Risk Determination \\n AUC = { round ( high_auc , 2 ) } ' , f 'Low-Moderate Risk Determination \\n AUC = { round ( low_auc , 2 ) } ' ]) plt . title ( 'ROC curve for Narcotic Score Discriminating High vs. \\n Moderate risk and Moderate vs. Low risk Prescription Opioid Use' ) fig . savefig ( 'img/Opioid_Risk_Metric_Threshold_Identification/figure1.png' ) plt . close () Image ( filename = 'img/Opioid_Risk_Metric_Threshold_Identification/figure1.png' )","title":"Discriminating Validity of the NS metric"},{"location":"notebooks/Opioid_Risk_Metric_Threshold_Identification-Study_Recreation/#risk-threshold-scores","text":"They next measured the agreement betwen the NS metric risk thresholds and the ASSIST score established risk thresholds using a confusion matrix below. Approximately 67.2% of the subjects were accurately mapped to the appropriate risk threshold using the NS metric, 17.0% of the participant classifications are false positives and the remaining 15.8% are false negatives. x = pd . DataFrame ( np . array ((( sum (( df . ASSIST_LOW == 1 ) & ( df . NS_LOW == 1 )), sum (( df . ASSIST_MEDIUM == 1 ) & ( df . NS_LOW == 1 )), sum (( df . ASSIST_HIGH == 1 ) & ( df . NS_LOW == 1 ))), ( sum (( df . ASSIST_LOW == 1 ) & ( df . NS_MEDIUM == 1 )), sum (( df . ASSIST_MEDIUM == 1 ) & ( df . NS_MEDIUM == 1 )), sum (( df . ASSIST_HIGH == 1 ) & ( df . NS_MEDIUM == 1 ))), ( sum (( df . ASSIST_LOW == 1 ) & ( df . NS_HIGH == 1 )), sum (( df . ASSIST_MEDIUM == 1 ) & ( df . NS_HIGH == 1 )), sum (( df . ASSIST_HIGH == 1 ) & ( df . NS_HIGH == 1 ))), ))) x . rename ( columns = { 0 : 'ASSIT Low Risk' , 1 : 'ASSIT Moderate Risk' , 2 : 'ASSIT High Risk' }, index = { 0 : 'NS Low Risk' , 1 : 'NS Moderate Risk' , 2 : 'NS High Risk' }, inplace = True ) table = x . astype ( str ) + ' - ' + ( 100 * x / x . sum () . sum ()) . round ( 1 ) . astype ( str ) + '%' Markdown ( table . to_markdown ()) ASSIT Low Risk ASSIT Moderate Risk ASSIT High Risk NS Low Risk 532 - 37.3% 194 - 13.6% 7 - 0.5% NS Moderate Risk 239 - 16.7% 426 - 29.8% 24 - 1.7% NS High Risk 1 - 0.1% 3 - 0.2% 2 - 0.1%","title":"Risk Threshold Scores"},{"location":"notebooks/Opioid_Risk_Metric_Threshold_Identification-Study_Recreation/#discussion-and-conclusions","text":"Cochran et al. argue that the accuracy of the NS metric in segmenting subjects by their opioid risk demonstrates that the NS metric is a fair screening tool for detecting risky prescription opioid use. Additionally, combining the number of correctly identified risk profiles with the number of subjects who have high opioid use but low reported risk (those subjects likely needing additional screening), the NS metric provides a meaningful level (86%) of clinically useful and actionable information. Cochran et al. argue that this high rate of accurate, clinically actionable insights would suggest that the NS metric may have an impactful role as a \"universal screen\" because of its high availability to community pharmacists and physicians and its relatively low barriers of use. They beleive that inn application, after pharmacists or clinicians receive a subject's NS metric, the pharmacists or clinicians may use the scores to triage subjects based on their respective risk profiles. If subjects are of moderate or high risk, as determined by their Narcotic Score, pharmacists may then use a decision support tool like the Prescription Drug Monitoring Clinical Decision Support Tool to assess which further risk assessment tools and patient recommendations to make. According to the paper, false positive misclassification is greatest among subjects with significant outlying factors to their pain management or prescription opioid use, such as disability or generally poor health. If the NS metric is applied in clinical practice, these false positive classifications would require further patient screening to rule out risks of opioid misuse and to allow pharmacists and clinicians to recommend additional pain management solutions. The study from Cochran et al. explains how the NS metric can be used as a universal screening tool for prescription opioid misuse risk by clinicians and pharmacists at the community level. In particular, the NS metric offers an easy-to-use format for identifying risky subject profiles with minimal effort required from either the subject or the pharmacist, and utilization of the NS metric is well positioned to inform decision-making by pharmacists and to compliment existing surveys for assessing subjects' risks of prescription opioid misuse.","title":"Discussion And Conclusions"},{"location":"notebooks/Opioid_Risk_Metric_Threshold_Identification-Study_Recreation/#references","text":"","title":"References"},{"location":"notebooks/Opioid_Risk_Metric_Threshold_Identification-Study_Recreation/#paper","text":"Cochran G, Brown J, Yu Z, Frede S, Bryan MA, Ferguson A, Bayyari N, Taylor B, Snyder ME, Charron E, Adeoye-Olatunde OA, Ghitza UE, Winhusen T. Validation and threshold identification of a prescription drug monitoring program clinical opioid risk metric with the WHO alcohol, smoking, and substance involvement screening test. Drug Alcohol Depend. 2021 Nov 1;228:109067. doi: 10.1016/j.drugalcdep.2021.109067. Epub 2021 Sep 24. PMID: 34610516; PMCID: PMC8612015.","title":"Paper"},{"location":"notebooks/Opioid_Risk_Metric_Threshold_Identification-Study_Recreation/#study","text":"Cochran G, Winhusen T. Validation of a Community Pharmacy-Based Prescription Drug Monitoring Program Risk Screening Tool. NIDA-CTN-0093. https://datashare.nida.nih.gov/study/nida-ctn-0093","title":"Study"},{"location":"notebooks/Stigma-Reduction-Among_PCCs/","text":"Stigma Reduction among Primary Care Clinicians towards People with OUD - A Study and Research Validation Analysis \u00b6 By J M Maxwell - Data Science, Sr. Analyst - CTDS \u00b6 Introduction \u00b6 In this notebook, we\u2019ll be replicating the published analyses by Hooker et al. in A randomized controlled trial of an intervention to reduce stigma toward people with opioid use disorder among primary care clinicians ( PMC9922036 ), in order to demonstrate how users might use these data. These data are available from NIDA Data Share through the HEAL Data Platform. There is an ongoing, dramatic rise in the number of opioid related overdose deaths in the United States, however only a small portion of patients who are diagnosed with Opioid Use Disorders (OUD) seek treatment and recieve medications for OUD (MOUD). MOUDs, like buprenorphine, can be effective forms of treatment for OUD patients, but only a portion of clinicians are waivered to, and in actuality do, prescribe buprenophine. A potential barrier to care for OUD patients may be the stigma held by primary care clinicians (PCCs) towards people with OUD. There are a limited number of interventions available for reducing OUD stigma among PCCs and a need for analytical support for the efficacy of these interventions. A randomized controlled trial of an intervention... examines whether PCCs' stigma towards people with OUD may be reduced and PCCs' intentions to treat OUD patients increased through online training interventions. This work was done exclusively to demonstrate the advantages of the HEAL Platform's Workspace feature and the ability to utilize data that is joined under the HEAL data mesh. While all the work here was completed by J M. Maxwell and members of the HEAL Platform team, this is not original work, and it is exclusively based off of the work completed by Hooker et al. The work here does not represent the official opinions, recommendations, or conclusions of Hooker et al. and this work does not represent policy or medical recommendations on behalf of the authors, the NIH HEAL Initiative, The Center For Translational Data Science, or The University of Chicago. Hooker, Stephanie A et al. \u201cA randomized controlled trial of an intervention to reduce stigma toward people with opioid use disorder among primary care clinicians.\u201d Addiction science & clinical practice vol. 18,1 10. 11 Feb. 2023, doi:10.1186/s13722-023-00366-1 Import Python Libraries \u00b6 ! pip install matplotlib - q ! pip install scikit - learn - q import zipfile import pandas as pd import numpy as np import scipy import matplotlib.pyplot as plt import sklearn from sklearn import metrics from IPython.display import Markdown Ingest And Prepare Data \u00b6 In this section we ingest and prepare the data. We're particularly interested in the data fields related to the PCCs' attitude towards people with OUD, their attitudes towards treating people with OUD, and their demographic information. ! gen3 drs - pull object dg . H34L / a6c7fc23 - 3534 - 401 c - 88 ca - 9 fbbb495dcf4 {\"succeeded\": [\"dg.H34L/a6c7fc23-3534-401c-88ca-9fbbb495dcf4\"], \"failed\": []} with zipfile . ZipFile ( 'ascii-crf-data-files_nida-ctn-0095a2 v1-1.zip' , 'r' ) as zip_ref : zip_ref . extractall ( '.' ) def clean_df ( df ): col_names = { 'DDBS' : 'Overall Stigma' , 'DDBS_DIFF' : 'Difference' , 'DDBS_DISDAIN' : 'Disdain' , 'DDBS_BLAME2' : 'Blame' , 'INTEND_WAIVER' : 'Intentions to get waivered' , 'INTEND_PRESCRIBE' : 'Intentions to prescribe buprenorphine' , 'WILLWORK' : 'Willingness to work with OUD' , 'TX_EFFECTIVE' : 'Perceived OUD treatment effectiveness' , 'TX_ADHERENCE' : 'Perceived OUD treatment adherence' , 'PCC_AGE' : 'Age' , 'PCC_GENDER' : 'Gender' , 'PCC_RACE' : 'Race' , 'PCC_HISPANIC' : 'Ethnicity' , 'STIGMA_GROUP' : 'Stigma Group' , 'PCC_WAIVERED' : 'Waivered to prescribe buprenorphine' , 'PCC_MD' : 'Degree' } df . rename ( columns = col_names , inplace = True ) for field in [ 'STIG_CLIN_ID' , 'HLTH_SYS_ID' , 'PCC_ID' , 'COMPLETE_TRAINING' , 'COMPLETE_SURVEY' ]: if field in df . columns : df . drop ([ field ], axis = 1 , inplace = True ) df . Gender = df . Gender . fillna ( 7.0 ) df . Ethnicity = df . Ethnicity . fillna ( 7.0 ) df [ 'Race' ] = df . Race . map ({ '5 White' : 'White' , '9 Prefer not to answer' : 'Prefer not to answer' , '2 Asian' : 'Asian' , '3 Black or African American' : 'Black or African American' , '7 Multiple selected' : 'Multiple selected' , '6 Some other race' : 'Some other race' }) df [ 'Gender' ] = df . Gender . map ({ 2.0 : 'Female' , 1.0 : 'Male' , 6.0 : 'Not Listed' , 7.0 : 'Prefer not to answer' }) df [ 'Ethnicity' ] = df . Ethnicity . map ({ 0.0 : 'Not Hispanic or Latino' , 1.0 : 'Hispanic or Latino' , 7.0 : 'Missing' }) df [ 'Waivered to prescribe buprenorphine' ] = df [ 'Waivered to prescribe buprenorphine' ] . map ({ 0 : 'False' , 1 : 'True' }) df [ 'Degree' ] = df . Degree . map ({ 1 : 'MD/DO' , 0 : 'PA/NP' }) keep_list = list ( set ( df . columns ) & set ([ 'Stigma Group' , 'Overall Stigma' , 'Difference' , 'Disdain' , 'Blame' , 'Intentions to get waivered' , 'Intentions to prescribe buprenorphine' , 'Willingness to work with OUD' , 'Perceived OUD treatment effectiveness' , 'Perceived OUD treatment adherence' , 'Waivered to prescribe buprenorphine' , 'Gender' , 'Ethnicity' , 'Race' , 'Degree' ])) df = df [ keep_list ] return df def make_print_df ( df ): features = [ 'Gender' , 'Ethnicity' , 'Race' , 'Waivered to prescribe buprenorphine' , 'Degree' ] all_subj = [] print_df = pd . DataFrame () N_AC = int ( df [ 'Stigma Group' ] . value_counts ()[ 'STIG_CTRL' ]) N_SR = int ( df [ 'Stigma Group' ] . value_counts ()[ 'STIG_INT' ]) N = N_AC + N_SR for feat in features : print_df1 = pd . DataFrame ({ 'Category' : f ' { feat } - ' + df [ feat ] . value_counts () . index , f 'All N= { N } ' : ( 100 * df [ feat ] . value_counts () / len ( df )) . values . round ( 2 )} ) print_df2 = pd . DataFrame ({ 'Category' : f ' { feat } - ' + ( 100 * df [ df [ 'Stigma Group' ] == 'STIG_INT' ][ feat ] . value_counts () / len ( df [ df [ 'Stigma Group' ] == 'STIG_INT' ])) . index , f 'Stigma reduction n\u2009=\u2009 { N_SR } ' : ( 100 * df [ df [ 'Stigma Group' ] == 'STIG_INT' ][ feat ] . value_counts () / len ( df [ df [ 'Stigma Group' ] == 'STIG_INT' ])) . values . round ( 2 )} ) print_df3 = pd . DataFrame ({ 'Category' : f ' { feat } - ' + ( 100 * df [ df [ 'Stigma Group' ] == 'STIG_CTRL' ][ feat ] . value_counts () / len ( df [ df [ 'Stigma Group' ] == 'STIG_CTRL' ])) . index , f 'Attention-control n\u2009=\u2009 { N_AC } ' : ( 100 * df [ df [ 'Stigma Group' ] == 'STIG_CTRL' ][ feat ] . value_counts () / len ( df [ df [ 'Stigma Group' ] == 'STIG_CTRL' ])) . values . round ( 2 )} ) print_df1 = print_df1 . merge ( print_df2 , how = 'left' , on = 'Category' ) print_df1 = print_df1 . merge ( print_df3 , how = 'left' , on = 'Category' ) print_df1 . fillna ( 0 , inplace = True ) print_df1 [[ f 'All N= { N } ' , f 'Stigma reduction n\u2009=\u2009 { N_SR } ' , f 'Attention-control n\u2009=\u2009 { N_AC } ' ]] = print_df1 [[ f 'All N= { N } ' , f 'Stigma reduction n\u2009=\u2009 { N_SR } ' , f 'Attention-control n\u2009=\u2009 { N_AC } ' ]] . astype ( str ) print_df1 [ f 'All N= { N } ' ] = print_df1 [ f 'All N= { N } ' ] . apply ( lambda x : str ( x ) + '%' ) print_df1 [ f 'Stigma reduction n\u2009=\u2009 { N_SR } ' ] = print_df1 [ f 'Stigma reduction n\u2009=\u2009 { N_SR } ' ] . apply ( lambda x : str ( x ) + '%' ) print_df1 [ f 'Attention-control n\u2009=\u2009 { N_AC } ' ] = print_df1 [ f 'Attention-control n\u2009=\u2009 { N_AC } ' ] . apply ( lambda x : str ( x ) + '%' ) print_df = pd . concat ([ print_df , print_df1 ]) if feat != 'Degree' : print_df = pd . concat ([ print_df , pd . DataFrame ({ 'Category' : [ '-' ], f 'All N= { N } ' : [ '-' ], f 'Stigma reduction n\u2009=\u2009 { N_SR } ' : [ '-' ], f 'Attention-control n\u2009=\u2009 { N_AC } ' : [ '-' ] })]) return print_df def make_impact_df ( df , features ): stig_int = [] stig_ctrl = [] t_vals = [] p_vals = [] d_vals = [] def cohen_d ( x , y ): nx = len ( x ) ny = len ( y ) dof = nx + ny - 2 return ( np . mean ( x ) - np . mean ( y )) / np . sqrt ((( nx - 1 ) * np . std ( x , ddof = 1 ) ** 2 + ( ny - 1 ) * np . std ( y , ddof = 1 ) ** 2 ) / dof ) for feat in features : x = df [ df [ 'Stigma Group' ] == 'STIG_INT' ][ feat ] . dropna () y = df [ df [ 'Stigma Group' ] == 'STIG_CTRL' ][ feat ] . dropna () # Perform the t-test t_statistic , p_value = scipy . stats . ttest_ind ( x , y ) d = cohen_d ( x , y ) . round ( 2 ) stig_int . append ( f ' { x . mean () . round ( 1 ) } ( { x . std () . round ( 1 ) } )' ) stig_ctrl . append ( f ' { y . mean () . round ( 1 ) } ( { y . std () . round ( 1 ) } )' ) t_vals . append ( t_statistic ) p_vals . append ( p_value ) d_vals . append ( d ) impact_df = pd . DataFrame ({ \"Feature\" : features , \"Stigma Reduction Mean (SD)\" : stig_int , \"Attention Control Mean (SD)\" : stig_ctrl , \"t-statistic\" : np . round ( t_vals , 3 ), \"p-value\" : np . round ( p_vals , 3 ), \"Cohen's d-value\" : d_vals }) return impact_df df = pd . read_csv ( 'stigma_supp.csv' ) df = clean_df ( df ) Markdown ( df . head () . to_markdown ()) Race Intentions to prescribe buprenorphine Degree Overall Stigma Difference Willingness to work with OUD Stigma Group Blame Intentions to get waivered Perceived OUD treatment effectiveness Ethnicity Waivered to prescribe buprenorphine Disdain Gender Perceived OUD treatment adherence 0 White 3 MD/DO 5.75 5.33 2 STIG_CTRL 5.5 1 2 Not Hispanic or Latino False 6.33 Male 2 1 White 2 MD/DO 4.5 3.33 3 STIG_INT 5 2 3 Not Hispanic or Latino False 5.33 Male 3 2 White 3 MD/DO 4.88 4.33 3 STIG_CTRL 5 2 3 Not Hispanic or Latino False 5.33 Male 2 3 White 2 MD/DO 4 3.67 2.67 STIG_INT 3.5 2 2 Not Hispanic or Latino False 4.67 Female 3 4 White 3 PA/NP 4.25 4.33 2.67 STIG_INT 3 3 3 Not Hispanic or Latino False 5 Female 2 About The Study \u00b6 The study used by Hooker et. al. for their research was conducted by a nonprofit healthcare organization, HealthPartners, servicing Minnesota and Wisconsin. PCCs who are part of the 15 HealPartners clinics that have access to a CDS tool for identifying and treating people with OUD were invited to participate in the study. The study was a randomized, controlled trial where PCCs recieved one of two trainings: a stigma reduction training or an attention-control training. Following training, the PCCs were assesed at 6 months, 3 months and immediately following completion of the training for their stigma against people with OUD, their intention to get waivered, and their intention to prescribe buprenorphine. Of the 162 PCCs who were eligible, 85 completed both the training and the immediate post training survey (n=46 stigma training and n=39 attention-control training). The stigma reduction training was a series of videos recounting OUD patient narratives, examples of using non-stigmatizing language, and explanantions on how to use a Clincal Decision Support (CDS) tool designed to enable PCCs to screen, diagnose, and treat patients with OUD. The attention-control training controlled for contact, attention, and extra CDS tool training, but did not include the OUD patient narratives or examples of non-stigmatized language. The outcome measures which were used in this analysis were assessed through a survey immediately following training. The relevant primary and secondary outcome measurements were: - OUD Stigma - measured using the Blame , Disdain , and Difference scales and the composite Overall Stigma scale. - Intentions to get waivered or prescribe buprenorphine - measured on a 1-5 scale the likelihood to get waivered to prescribe buprenorphine or to prescribe buprenorphine should a waiver no longer be required. - Willingness to work with people with OUD - measured as the average of 3 questionnaire items (each scaled 1-5) from the Drug Problems Perceptions Questionnaire, where a higher score indicates a greater overall willingness to work with patients with OUD. - Opioid treatment outcome expectations - measured on a scale 1-4 on PCCs expecations for the effectiveness and likelihood of patient adherence to OUD treatment. Demographic Summary Statistics of PCCs who completed stigma or attention control training \u00b6 print_df = make_print_df ( df ) Markdown ( print_df . to_markdown ()) Category All N=85 Stigma reduction n\u2009=\u200946 Attention-control n\u2009=\u200939 0 Gender - Female 57.65% 58.7% 56.41% 1 Gender - Male 36.47% 36.96% 35.9% 2 Gender - Prefer not to answer 4.71% 2.17% 7.69% 3 Gender - Not Listed 1.18% 2.17% 0.0% 0 - - - - 0 Ethnicity - Not Hispanic or Latino 94.12% 97.83% 89.74% 1 Ethnicity - Hispanic or Latino 3.53% 2.17% 5.13% 2 Ethnicity - Missing 2.35% 0.0% 5.13% 0 - - - - 0 Race - White 67.06% 63.04% 71.79% 1 Race - Prefer not to answer 14.12% 15.22% 12.82% 2 Race - Asian 9.41% 13.04% 5.13% 3 Race - Black or African American 7.06% 6.52% 7.69% 4 Race - Multiple selected 1.18% 0.0% 2.56% 5 Race - Some other race 1.18% 2.17% 0.0% 0 - - - - 0 Waivered to prescribe buprenorphine - False 90.59% 93.48% 87.18% 1 Waivered to prescribe buprenorphine - True 9.41% 6.52% 12.82% 0 - - - - 0 Degree - MD/DO 64.71% 65.22% 64.1% 1 Degree - PA/NP 35.29% 34.78% 35.9% In this first table we have a breakdown of the demographic characteristics of the participating PCCs split amongst the two training formats. There are no significant differences between the stigma and attention-control training groups in their demographics, their medical degree type, or their pre-existing waiver to prescribe burprenorphine. Stigma Reduction and Attention-Control Training on Self-Reported Stigma and Intentions to Treat People \u00b6 features = [ 'Overall Stigma' , 'Difference' , 'Disdain' , 'Blame' , 'Intentions to get waivered' , 'Intentions to prescribe buprenorphine' , 'Willingness to work with OUD' , 'Perceived OUD treatment effectiveness' , 'Perceived OUD treatment adherence' ] impact_df = make_impact_df ( df , features ) Markdown ( impact_df . to_markdown ()) Feature Stigma Reduction Mean (SD) Attention Control Mean (SD) t-statistic p-value Cohen's d-value 0 Overall Stigma 4.1 (1.3) 4.2 (1.2) -0.481 0.632 -0.1 1 Difference 3.4 (1.7) 3.1 (1.7) 0.741 0.461 0.16 2 Disdain 4.7 (1.4) 4.9 (1.4) -0.859 0.393 -0.19 3 Blame 4.4 (1.6) 4.8 (1.6) -1.286 0.202 -0.28 4 Intentions to get waivered 2.3 (0.7) 2.1 (0.8) 1.113 0.269 0.26 5 Intentions to prescribe buprenorphine 3.2 (1.0) 3.0 (0.9) 0.899 0.372 0.21 6 Willingness to work with OUD 3.0 (0.7) 3.1 (0.9) -0.828 0.41 -0.18 7 Perceived OUD treatment effectiveness 2.6 (0.8) 2.7 (0.7) -0.745 0.459 -0.16 8 Perceived OUD treatment adherence 2.5 (0.6) 2.4 (0.6) 0.15 0.881 0.03 In the second table we show a number of descriptive statistics for measuring the difference amongst the two training groups in self-reported stigma (Overall Stigma, Difference, Disdain, and Blame), intentions for getting waivered or to prescribe buprenophine if waivered, and perceptions of people with OUD and OUD treatment. The mean and standard deviations for both training groups, as well as, the t-statistic, corresponding p-value, and Cohen's d-value all demonstrate that there are minimal or no significant differences between the two training groups across all measured training outcomes. Correlations among Self-Reported Sitgma and Intentions to Treat People \u00b6 corr_matrix = df [ features ] . corr () . round ( 2 ) mask = np . triu ( np . ones_like ( corr_matrix , dtype = bool )) corr_matrix . columns = [ '1' , '2' , '3' , '4' , '5' , '6' , '7' , '8' , '9' ] Markdown ( corr_matrix . mask ( mask ) . to_markdown ()) 1 2 3 4 5 6 7 8 9 Overall Stigma nan nan nan nan nan nan nan nan nan Difference 0.84 nan nan nan nan nan nan nan nan Disdain 0.79 0.47 nan nan nan nan nan nan nan Blame 0.64 0.31 0.33 nan nan nan nan nan nan Intentions to get waivered -0.25 -0.06 -0.23 -0.35 nan nan nan nan nan Intentions to prescribe buprenorphine -0.25 -0.11 -0.18 -0.35 0.61 nan nan nan nan Willingness to work with OUD -0.4 -0.34 -0.29 -0.34 0.42 0.46 nan nan nan Perceived OUD treatment effectiveness -0.32 -0.19 -0.26 -0.38 0.21 0.29 0.46 nan nan Perceived OUD treatment adherence -0.39 -0.28 -0.31 -0.35 0.17 0.22 0.36 0.62 nan In the final table above, we can see how self-reported stigma, intentions for getting waivered or to prescribe buprenophine if waivered, and perceptions of people with OUD and OUD treatment are related. We use Pearson's correlation coefficients to measure the relation between the measured training outcomes. Unsurprisingly, the components for measuring stigma are strongly, positively correlated. We can also see moderate or high positive correlations between Perceived OUD treatment adherence and treatment effectiveness, between PCCs' intentions to get waivered and to prescribe buprenorphine, and between PCCs' willingness to work with OUD patients and the PCCs intentions to prescribe buprenorphine and their perceived OUD treatment effectiveness/adherence. There is also a slight or moderate negative correlation between PCCs' self-reported stigma and their intensions to work with OUD patients, their percieved OUD treatment effectiveness/adherence, and their intention to get waivered and prescribe buprenorphine. Conclusions \u00b6 The study demonstrated there was little relation between the provided stigma reduction training and PCCs' stigma, future intentions, willingness to work with OUD patients, or PCCs' perception of treatment effectiveness or patient treatment adherence. As was expected, there was a relation amongst PCCs' established stigma and their willingness to work with OUD patients and their perceptions of OUD treatment effectiveness and adherence. Since greater established PCC stigma is shown to inversely relate to PCCs' willingness to treat people with OUD, intentions to prescribe buprenophine, and perceptions regarding treatment effectiveness and patient adherence to treatment, it is important to find more effective intervention methods for reducing stigma. Citations \u00b6 Hooker, Stephanie A et al. \u201cA randomized controlled trial of an intervention to reduce stigma toward people with opioid use disorder among primary care clinicians.\u201d Addiction science & clinical practice vol. 18,1 10. 11 Feb. 2023, doi:10.1186/s13722-023-00366-1 Hooker, S., Rossum, R., Crain, L., Bart, G. \"Reducing Stigma toward People with Opioid Use Disorder among Primary Care Clinicians.\" NIDA Data Share. May 2024, NIDA-CTN-0095A2","title":"Stigma Reduction Among PCCs"},{"location":"notebooks/Stigma-Reduction-Among_PCCs/#stigma-reduction-among-primary-care-clinicians-towards-people-with-oud-a-study-and-research-validation-analysis","text":"","title":"Stigma Reduction among Primary Care Clinicians towards People with OUD - A Study and Research Validation Analysis"},{"location":"notebooks/Stigma-Reduction-Among_PCCs/#by-j-m-maxwell-data-science-sr-analyst-ctds","text":"","title":"By J M Maxwell - Data Science, Sr. Analyst - CTDS"},{"location":"notebooks/Stigma-Reduction-Among_PCCs/#introduction","text":"In this notebook, we\u2019ll be replicating the published analyses by Hooker et al. in A randomized controlled trial of an intervention to reduce stigma toward people with opioid use disorder among primary care clinicians ( PMC9922036 ), in order to demonstrate how users might use these data. These data are available from NIDA Data Share through the HEAL Data Platform. There is an ongoing, dramatic rise in the number of opioid related overdose deaths in the United States, however only a small portion of patients who are diagnosed with Opioid Use Disorders (OUD) seek treatment and recieve medications for OUD (MOUD). MOUDs, like buprenorphine, can be effective forms of treatment for OUD patients, but only a portion of clinicians are waivered to, and in actuality do, prescribe buprenophine. A potential barrier to care for OUD patients may be the stigma held by primary care clinicians (PCCs) towards people with OUD. There are a limited number of interventions available for reducing OUD stigma among PCCs and a need for analytical support for the efficacy of these interventions. A randomized controlled trial of an intervention... examines whether PCCs' stigma towards people with OUD may be reduced and PCCs' intentions to treat OUD patients increased through online training interventions. This work was done exclusively to demonstrate the advantages of the HEAL Platform's Workspace feature and the ability to utilize data that is joined under the HEAL data mesh. While all the work here was completed by J M. Maxwell and members of the HEAL Platform team, this is not original work, and it is exclusively based off of the work completed by Hooker et al. The work here does not represent the official opinions, recommendations, or conclusions of Hooker et al. and this work does not represent policy or medical recommendations on behalf of the authors, the NIH HEAL Initiative, The Center For Translational Data Science, or The University of Chicago. Hooker, Stephanie A et al. \u201cA randomized controlled trial of an intervention to reduce stigma toward people with opioid use disorder among primary care clinicians.\u201d Addiction science & clinical practice vol. 18,1 10. 11 Feb. 2023, doi:10.1186/s13722-023-00366-1","title":"Introduction"},{"location":"notebooks/Stigma-Reduction-Among_PCCs/#import-python-libraries","text":"! pip install matplotlib - q ! pip install scikit - learn - q import zipfile import pandas as pd import numpy as np import scipy import matplotlib.pyplot as plt import sklearn from sklearn import metrics from IPython.display import Markdown","title":"Import Python Libraries"},{"location":"notebooks/Stigma-Reduction-Among_PCCs/#ingest-and-prepare-data","text":"In this section we ingest and prepare the data. We're particularly interested in the data fields related to the PCCs' attitude towards people with OUD, their attitudes towards treating people with OUD, and their demographic information. ! gen3 drs - pull object dg . H34L / a6c7fc23 - 3534 - 401 c - 88 ca - 9 fbbb495dcf4 {\"succeeded\": [\"dg.H34L/a6c7fc23-3534-401c-88ca-9fbbb495dcf4\"], \"failed\": []} with zipfile . ZipFile ( 'ascii-crf-data-files_nida-ctn-0095a2 v1-1.zip' , 'r' ) as zip_ref : zip_ref . extractall ( '.' ) def clean_df ( df ): col_names = { 'DDBS' : 'Overall Stigma' , 'DDBS_DIFF' : 'Difference' , 'DDBS_DISDAIN' : 'Disdain' , 'DDBS_BLAME2' : 'Blame' , 'INTEND_WAIVER' : 'Intentions to get waivered' , 'INTEND_PRESCRIBE' : 'Intentions to prescribe buprenorphine' , 'WILLWORK' : 'Willingness to work with OUD' , 'TX_EFFECTIVE' : 'Perceived OUD treatment effectiveness' , 'TX_ADHERENCE' : 'Perceived OUD treatment adherence' , 'PCC_AGE' : 'Age' , 'PCC_GENDER' : 'Gender' , 'PCC_RACE' : 'Race' , 'PCC_HISPANIC' : 'Ethnicity' , 'STIGMA_GROUP' : 'Stigma Group' , 'PCC_WAIVERED' : 'Waivered to prescribe buprenorphine' , 'PCC_MD' : 'Degree' } df . rename ( columns = col_names , inplace = True ) for field in [ 'STIG_CLIN_ID' , 'HLTH_SYS_ID' , 'PCC_ID' , 'COMPLETE_TRAINING' , 'COMPLETE_SURVEY' ]: if field in df . columns : df . drop ([ field ], axis = 1 , inplace = True ) df . Gender = df . Gender . fillna ( 7.0 ) df . Ethnicity = df . Ethnicity . fillna ( 7.0 ) df [ 'Race' ] = df . Race . map ({ '5 White' : 'White' , '9 Prefer not to answer' : 'Prefer not to answer' , '2 Asian' : 'Asian' , '3 Black or African American' : 'Black or African American' , '7 Multiple selected' : 'Multiple selected' , '6 Some other race' : 'Some other race' }) df [ 'Gender' ] = df . Gender . map ({ 2.0 : 'Female' , 1.0 : 'Male' , 6.0 : 'Not Listed' , 7.0 : 'Prefer not to answer' }) df [ 'Ethnicity' ] = df . Ethnicity . map ({ 0.0 : 'Not Hispanic or Latino' , 1.0 : 'Hispanic or Latino' , 7.0 : 'Missing' }) df [ 'Waivered to prescribe buprenorphine' ] = df [ 'Waivered to prescribe buprenorphine' ] . map ({ 0 : 'False' , 1 : 'True' }) df [ 'Degree' ] = df . Degree . map ({ 1 : 'MD/DO' , 0 : 'PA/NP' }) keep_list = list ( set ( df . columns ) & set ([ 'Stigma Group' , 'Overall Stigma' , 'Difference' , 'Disdain' , 'Blame' , 'Intentions to get waivered' , 'Intentions to prescribe buprenorphine' , 'Willingness to work with OUD' , 'Perceived OUD treatment effectiveness' , 'Perceived OUD treatment adherence' , 'Waivered to prescribe buprenorphine' , 'Gender' , 'Ethnicity' , 'Race' , 'Degree' ])) df = df [ keep_list ] return df def make_print_df ( df ): features = [ 'Gender' , 'Ethnicity' , 'Race' , 'Waivered to prescribe buprenorphine' , 'Degree' ] all_subj = [] print_df = pd . DataFrame () N_AC = int ( df [ 'Stigma Group' ] . value_counts ()[ 'STIG_CTRL' ]) N_SR = int ( df [ 'Stigma Group' ] . value_counts ()[ 'STIG_INT' ]) N = N_AC + N_SR for feat in features : print_df1 = pd . DataFrame ({ 'Category' : f ' { feat } - ' + df [ feat ] . value_counts () . index , f 'All N= { N } ' : ( 100 * df [ feat ] . value_counts () / len ( df )) . values . round ( 2 )} ) print_df2 = pd . DataFrame ({ 'Category' : f ' { feat } - ' + ( 100 * df [ df [ 'Stigma Group' ] == 'STIG_INT' ][ feat ] . value_counts () / len ( df [ df [ 'Stigma Group' ] == 'STIG_INT' ])) . index , f 'Stigma reduction n\u2009=\u2009 { N_SR } ' : ( 100 * df [ df [ 'Stigma Group' ] == 'STIG_INT' ][ feat ] . value_counts () / len ( df [ df [ 'Stigma Group' ] == 'STIG_INT' ])) . values . round ( 2 )} ) print_df3 = pd . DataFrame ({ 'Category' : f ' { feat } - ' + ( 100 * df [ df [ 'Stigma Group' ] == 'STIG_CTRL' ][ feat ] . value_counts () / len ( df [ df [ 'Stigma Group' ] == 'STIG_CTRL' ])) . index , f 'Attention-control n\u2009=\u2009 { N_AC } ' : ( 100 * df [ df [ 'Stigma Group' ] == 'STIG_CTRL' ][ feat ] . value_counts () / len ( df [ df [ 'Stigma Group' ] == 'STIG_CTRL' ])) . values . round ( 2 )} ) print_df1 = print_df1 . merge ( print_df2 , how = 'left' , on = 'Category' ) print_df1 = print_df1 . merge ( print_df3 , how = 'left' , on = 'Category' ) print_df1 . fillna ( 0 , inplace = True ) print_df1 [[ f 'All N= { N } ' , f 'Stigma reduction n\u2009=\u2009 { N_SR } ' , f 'Attention-control n\u2009=\u2009 { N_AC } ' ]] = print_df1 [[ f 'All N= { N } ' , f 'Stigma reduction n\u2009=\u2009 { N_SR } ' , f 'Attention-control n\u2009=\u2009 { N_AC } ' ]] . astype ( str ) print_df1 [ f 'All N= { N } ' ] = print_df1 [ f 'All N= { N } ' ] . apply ( lambda x : str ( x ) + '%' ) print_df1 [ f 'Stigma reduction n\u2009=\u2009 { N_SR } ' ] = print_df1 [ f 'Stigma reduction n\u2009=\u2009 { N_SR } ' ] . apply ( lambda x : str ( x ) + '%' ) print_df1 [ f 'Attention-control n\u2009=\u2009 { N_AC } ' ] = print_df1 [ f 'Attention-control n\u2009=\u2009 { N_AC } ' ] . apply ( lambda x : str ( x ) + '%' ) print_df = pd . concat ([ print_df , print_df1 ]) if feat != 'Degree' : print_df = pd . concat ([ print_df , pd . DataFrame ({ 'Category' : [ '-' ], f 'All N= { N } ' : [ '-' ], f 'Stigma reduction n\u2009=\u2009 { N_SR } ' : [ '-' ], f 'Attention-control n\u2009=\u2009 { N_AC } ' : [ '-' ] })]) return print_df def make_impact_df ( df , features ): stig_int = [] stig_ctrl = [] t_vals = [] p_vals = [] d_vals = [] def cohen_d ( x , y ): nx = len ( x ) ny = len ( y ) dof = nx + ny - 2 return ( np . mean ( x ) - np . mean ( y )) / np . sqrt ((( nx - 1 ) * np . std ( x , ddof = 1 ) ** 2 + ( ny - 1 ) * np . std ( y , ddof = 1 ) ** 2 ) / dof ) for feat in features : x = df [ df [ 'Stigma Group' ] == 'STIG_INT' ][ feat ] . dropna () y = df [ df [ 'Stigma Group' ] == 'STIG_CTRL' ][ feat ] . dropna () # Perform the t-test t_statistic , p_value = scipy . stats . ttest_ind ( x , y ) d = cohen_d ( x , y ) . round ( 2 ) stig_int . append ( f ' { x . mean () . round ( 1 ) } ( { x . std () . round ( 1 ) } )' ) stig_ctrl . append ( f ' { y . mean () . round ( 1 ) } ( { y . std () . round ( 1 ) } )' ) t_vals . append ( t_statistic ) p_vals . append ( p_value ) d_vals . append ( d ) impact_df = pd . DataFrame ({ \"Feature\" : features , \"Stigma Reduction Mean (SD)\" : stig_int , \"Attention Control Mean (SD)\" : stig_ctrl , \"t-statistic\" : np . round ( t_vals , 3 ), \"p-value\" : np . round ( p_vals , 3 ), \"Cohen's d-value\" : d_vals }) return impact_df df = pd . read_csv ( 'stigma_supp.csv' ) df = clean_df ( df ) Markdown ( df . head () . to_markdown ()) Race Intentions to prescribe buprenorphine Degree Overall Stigma Difference Willingness to work with OUD Stigma Group Blame Intentions to get waivered Perceived OUD treatment effectiveness Ethnicity Waivered to prescribe buprenorphine Disdain Gender Perceived OUD treatment adherence 0 White 3 MD/DO 5.75 5.33 2 STIG_CTRL 5.5 1 2 Not Hispanic or Latino False 6.33 Male 2 1 White 2 MD/DO 4.5 3.33 3 STIG_INT 5 2 3 Not Hispanic or Latino False 5.33 Male 3 2 White 3 MD/DO 4.88 4.33 3 STIG_CTRL 5 2 3 Not Hispanic or Latino False 5.33 Male 2 3 White 2 MD/DO 4 3.67 2.67 STIG_INT 3.5 2 2 Not Hispanic or Latino False 4.67 Female 3 4 White 3 PA/NP 4.25 4.33 2.67 STIG_INT 3 3 3 Not Hispanic or Latino False 5 Female 2","title":"Ingest And Prepare Data"},{"location":"notebooks/Stigma-Reduction-Among_PCCs/#about-the-study","text":"The study used by Hooker et. al. for their research was conducted by a nonprofit healthcare organization, HealthPartners, servicing Minnesota and Wisconsin. PCCs who are part of the 15 HealPartners clinics that have access to a CDS tool for identifying and treating people with OUD were invited to participate in the study. The study was a randomized, controlled trial where PCCs recieved one of two trainings: a stigma reduction training or an attention-control training. Following training, the PCCs were assesed at 6 months, 3 months and immediately following completion of the training for their stigma against people with OUD, their intention to get waivered, and their intention to prescribe buprenorphine. Of the 162 PCCs who were eligible, 85 completed both the training and the immediate post training survey (n=46 stigma training and n=39 attention-control training). The stigma reduction training was a series of videos recounting OUD patient narratives, examples of using non-stigmatizing language, and explanantions on how to use a Clincal Decision Support (CDS) tool designed to enable PCCs to screen, diagnose, and treat patients with OUD. The attention-control training controlled for contact, attention, and extra CDS tool training, but did not include the OUD patient narratives or examples of non-stigmatized language. The outcome measures which were used in this analysis were assessed through a survey immediately following training. The relevant primary and secondary outcome measurements were: - OUD Stigma - measured using the Blame , Disdain , and Difference scales and the composite Overall Stigma scale. - Intentions to get waivered or prescribe buprenorphine - measured on a 1-5 scale the likelihood to get waivered to prescribe buprenorphine or to prescribe buprenorphine should a waiver no longer be required. - Willingness to work with people with OUD - measured as the average of 3 questionnaire items (each scaled 1-5) from the Drug Problems Perceptions Questionnaire, where a higher score indicates a greater overall willingness to work with patients with OUD. - Opioid treatment outcome expectations - measured on a scale 1-4 on PCCs expecations for the effectiveness and likelihood of patient adherence to OUD treatment.","title":"About The Study"},{"location":"notebooks/Stigma-Reduction-Among_PCCs/#demographic-summary-statistics-of-pccs-who-completed-stigma-or-attention-control-training","text":"print_df = make_print_df ( df ) Markdown ( print_df . to_markdown ()) Category All N=85 Stigma reduction n\u2009=\u200946 Attention-control n\u2009=\u200939 0 Gender - Female 57.65% 58.7% 56.41% 1 Gender - Male 36.47% 36.96% 35.9% 2 Gender - Prefer not to answer 4.71% 2.17% 7.69% 3 Gender - Not Listed 1.18% 2.17% 0.0% 0 - - - - 0 Ethnicity - Not Hispanic or Latino 94.12% 97.83% 89.74% 1 Ethnicity - Hispanic or Latino 3.53% 2.17% 5.13% 2 Ethnicity - Missing 2.35% 0.0% 5.13% 0 - - - - 0 Race - White 67.06% 63.04% 71.79% 1 Race - Prefer not to answer 14.12% 15.22% 12.82% 2 Race - Asian 9.41% 13.04% 5.13% 3 Race - Black or African American 7.06% 6.52% 7.69% 4 Race - Multiple selected 1.18% 0.0% 2.56% 5 Race - Some other race 1.18% 2.17% 0.0% 0 - - - - 0 Waivered to prescribe buprenorphine - False 90.59% 93.48% 87.18% 1 Waivered to prescribe buprenorphine - True 9.41% 6.52% 12.82% 0 - - - - 0 Degree - MD/DO 64.71% 65.22% 64.1% 1 Degree - PA/NP 35.29% 34.78% 35.9% In this first table we have a breakdown of the demographic characteristics of the participating PCCs split amongst the two training formats. There are no significant differences between the stigma and attention-control training groups in their demographics, their medical degree type, or their pre-existing waiver to prescribe burprenorphine.","title":"Demographic Summary Statistics of PCCs who completed stigma or attention control training"},{"location":"notebooks/Stigma-Reduction-Among_PCCs/#stigma-reduction-and-attention-control-training-on-self-reported-stigma-and-intentions-to-treat-people","text":"features = [ 'Overall Stigma' , 'Difference' , 'Disdain' , 'Blame' , 'Intentions to get waivered' , 'Intentions to prescribe buprenorphine' , 'Willingness to work with OUD' , 'Perceived OUD treatment effectiveness' , 'Perceived OUD treatment adherence' ] impact_df = make_impact_df ( df , features ) Markdown ( impact_df . to_markdown ()) Feature Stigma Reduction Mean (SD) Attention Control Mean (SD) t-statistic p-value Cohen's d-value 0 Overall Stigma 4.1 (1.3) 4.2 (1.2) -0.481 0.632 -0.1 1 Difference 3.4 (1.7) 3.1 (1.7) 0.741 0.461 0.16 2 Disdain 4.7 (1.4) 4.9 (1.4) -0.859 0.393 -0.19 3 Blame 4.4 (1.6) 4.8 (1.6) -1.286 0.202 -0.28 4 Intentions to get waivered 2.3 (0.7) 2.1 (0.8) 1.113 0.269 0.26 5 Intentions to prescribe buprenorphine 3.2 (1.0) 3.0 (0.9) 0.899 0.372 0.21 6 Willingness to work with OUD 3.0 (0.7) 3.1 (0.9) -0.828 0.41 -0.18 7 Perceived OUD treatment effectiveness 2.6 (0.8) 2.7 (0.7) -0.745 0.459 -0.16 8 Perceived OUD treatment adherence 2.5 (0.6) 2.4 (0.6) 0.15 0.881 0.03 In the second table we show a number of descriptive statistics for measuring the difference amongst the two training groups in self-reported stigma (Overall Stigma, Difference, Disdain, and Blame), intentions for getting waivered or to prescribe buprenophine if waivered, and perceptions of people with OUD and OUD treatment. The mean and standard deviations for both training groups, as well as, the t-statistic, corresponding p-value, and Cohen's d-value all demonstrate that there are minimal or no significant differences between the two training groups across all measured training outcomes.","title":"Stigma Reduction and Attention-Control Training on Self-Reported Stigma and Intentions to Treat People"},{"location":"notebooks/Stigma-Reduction-Among_PCCs/#correlations-among-self-reported-sitgma-and-intentions-to-treat-people","text":"corr_matrix = df [ features ] . corr () . round ( 2 ) mask = np . triu ( np . ones_like ( corr_matrix , dtype = bool )) corr_matrix . columns = [ '1' , '2' , '3' , '4' , '5' , '6' , '7' , '8' , '9' ] Markdown ( corr_matrix . mask ( mask ) . to_markdown ()) 1 2 3 4 5 6 7 8 9 Overall Stigma nan nan nan nan nan nan nan nan nan Difference 0.84 nan nan nan nan nan nan nan nan Disdain 0.79 0.47 nan nan nan nan nan nan nan Blame 0.64 0.31 0.33 nan nan nan nan nan nan Intentions to get waivered -0.25 -0.06 -0.23 -0.35 nan nan nan nan nan Intentions to prescribe buprenorphine -0.25 -0.11 -0.18 -0.35 0.61 nan nan nan nan Willingness to work with OUD -0.4 -0.34 -0.29 -0.34 0.42 0.46 nan nan nan Perceived OUD treatment effectiveness -0.32 -0.19 -0.26 -0.38 0.21 0.29 0.46 nan nan Perceived OUD treatment adherence -0.39 -0.28 -0.31 -0.35 0.17 0.22 0.36 0.62 nan In the final table above, we can see how self-reported stigma, intentions for getting waivered or to prescribe buprenophine if waivered, and perceptions of people with OUD and OUD treatment are related. We use Pearson's correlation coefficients to measure the relation between the measured training outcomes. Unsurprisingly, the components for measuring stigma are strongly, positively correlated. We can also see moderate or high positive correlations between Perceived OUD treatment adherence and treatment effectiveness, between PCCs' intentions to get waivered and to prescribe buprenorphine, and between PCCs' willingness to work with OUD patients and the PCCs intentions to prescribe buprenorphine and their perceived OUD treatment effectiveness/adherence. There is also a slight or moderate negative correlation between PCCs' self-reported stigma and their intensions to work with OUD patients, their percieved OUD treatment effectiveness/adherence, and their intention to get waivered and prescribe buprenorphine.","title":"Correlations among Self-Reported Sitgma and Intentions to Treat People"},{"location":"notebooks/Stigma-Reduction-Among_PCCs/#conclusions","text":"The study demonstrated there was little relation between the provided stigma reduction training and PCCs' stigma, future intentions, willingness to work with OUD patients, or PCCs' perception of treatment effectiveness or patient treatment adherence. As was expected, there was a relation amongst PCCs' established stigma and their willingness to work with OUD patients and their perceptions of OUD treatment effectiveness and adherence. Since greater established PCC stigma is shown to inversely relate to PCCs' willingness to treat people with OUD, intentions to prescribe buprenophine, and perceptions regarding treatment effectiveness and patient adherence to treatment, it is important to find more effective intervention methods for reducing stigma.","title":"Conclusions"},{"location":"notebooks/Stigma-Reduction-Among_PCCs/#citations","text":"Hooker, Stephanie A et al. \u201cA randomized controlled trial of an intervention to reduce stigma toward people with opioid use disorder among primary care clinicians.\u201d Addiction science & clinical practice vol. 18,1 10. 11 Feb. 2023, doi:10.1186/s13722-023-00366-1 Hooker, S., Rossum, R., Crain, L., Bart, G. \"Reducing Stigma toward People with Opioid Use Disorder among Primary Care Clinicians.\" NIDA Data Share. May 2024, NIDA-CTN-0095A2","title":"Citations"}]}